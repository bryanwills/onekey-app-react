"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[68144],{567967:(e,t,r)=>{r.d(t,{Xp:()=>n.Xp,yZ:()=>useBrowserAction,Gd:()=>useBrowserBookmarkAction,cS:()=>useBrowserHistoryAction,AO:()=>useBrowserTabActions,AS:()=>n.AS,Do:()=>n.Do,pJ:()=>n.pJ,nD:()=>n.nD});var n=r(603614),o=r(586330),a=r(324586),i=r(946343),s=r.n(i),c=r(230414),l=r(929296),u=r(195309),d=r(972715),b=r(514041),p=r(490343),f=r(310955),g=r(262873),h=r(714178),y=r(971670),m=r(660015),S=r(849726),w=(r(663522),r(730223),r(657355)),k=r(482407),v=r(796151),x=function(e){return e.Valid="Valid",e.InvalidUrl="InvalidUrl",e.NotSupportProtocol="NotSupportProtocol",e.ValidDeeplink="ValidDeeplink",e.InvalidPunycode="InvalidPunycode",e}({});function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,a.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function _createSuper(e){var t=_isNativeReflectConstruct();return function _createSuperInternal(){var r,n=(0,d.A)(e);if(t){var o=(0,d.A)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return(0,u.A)(this,r)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var j={};var $="about:blank",D={id:"home",url:$,title:"OneKey",canGoBack:!1,loading:!1,favicon:""},A=function(e){(0,l.A)(ContextJotaiActionsDiscovery,e);var t=_createSuper(ContextJotaiActionsDiscovery);function ContextJotaiActionsDiscovery(...e){var r,a,i,c,l,u,d,b,h;return(r=t.call(this,...e)).setDisplayHomePage=(0,n.q0)((function(e,t,r){t((0,n.QL)(),r)})),r.buildWebTabs=(0,n.q0)((function(e,t,r){var o=e((0,n.cl)()),{data:a,options:i}=r,c=a;if(!Array.isArray(a))throw new Error("setWebTabsWriteAtom: payload must be an array");c&&c.length||(c=[]);var l=function buildWebTabData(e){var t={},r=[];return e.sort((function(e,t){return e.timestamp&&t.timestamp?e.timestamp-t.timestamp:0})),e.forEach((function(e){r.push(e.id),t[e.id]=e})),{data:e,keys:r,map:t}}(c);s()(l.keys,o.keys)&&!i?.forceUpdate||t((0,n.cl)(),{keys:l.keys,tabs:l.data}),t((0,n.GW)(),(function(){return l.map})),f.A.simpleDb.browserTabs.setRawData({tabs:l.data})})),r.refreshTabs=(0,n.q0)((function(e,t){var{tabs:o}=e((0,n.cl)()),a=[...o];r.buildWebTabs.call(t,{data:a,options:{forceUpdate:!0}})})),r.setCurrentWebTab=(0,n.q0)((function(e,t,o){var a=e((0,n.WL)());if(a!==o){r.pauseDappInteraction.call(t,a);var{tabs:i}=e((0,n.cl)()),s=i.findIndex((function(e){return e.id===o}));i.forEach((function(e){e.isActive=!1})),r.buildWebTabs.call(t,{data:[...i]}),-1!==s?(i[s].isActive=!0,t((0,n.WL)(),o),r.resumeDappInteraction.call(t,o)):t((0,n.WL)(),"")}var c=e((0,n.QL)());o&&c&&r.setDisplayHomePage.call(t,!1),o||c||r.setDisplayHomePage.call(t,!0)})),r.addWebTab=(0,n.q0)((function(e,t,o){var a,i=performance.now(),{tabs:s}=e((0,n.cl)());o.id&&o.id!==D.id||(o.id=(0,k.lk)()),o.timestamp=Date.now(),r.buildWebTabs.call(t,{data:[...s,o]}),r.setCurrentWebTab.call(t,null!=(a=o.id)?a:"");var c=performance.now();console.log(`addBlankWebTab took ${c-i} milliseconds.`)})),r.addBlankWebTab=(0,n.q0)((function(e,t){r.addWebTab.call(t,_objectSpread(_objectSpread({},D),{},{isActive:!0}))})),r.setWebTabData=(0,n.q0)((function(e,t,o){var{tabs:a}=e((0,n.cl)()),i=a,s=i.findIndex((function(e){return e.id===o.id}));if(s>-1){var c=i[s];Object.keys(o).forEach((function(e){var t=e,r=o[t];if(void 0!==r&&r!==c[t]){if("title"===t&&!r)return;c[t]=r,"url"===t&&(c.timestamp=Date.now(),"about:blank"===r&&o.id&&(j[o.id]=c.timestamp))}})),i[s]=c,r.buildWebTabs.call(t,{data:i})}})),r.closeWebTab=(0,n.q0)((function(e,t,o){delete m.O3[o];var{tabs:a}=e((0,n.cl)()),i=e((0,n.WL)()),s=a.findIndex((function(e){return e.id===o}));if(-1!==s){var c=a[s].id===i;if(a.splice(s,1),c){var l=s-1;if(l<0&&a.length>0&&(l=0),l>=0){var u=a[l];u.isActive=!0,r.setCurrentWebTab.call(t,u.id)}}}r.buildWebTabs.call(t,{data:[...a]})})),r.closeAllWebTabs=(0,n.q0)((function(e,t){var{tabs:o}=e((0,n.cl)()),a=e((0,n.WL)()),i=o.filter((function(e){return e.isPinned}));i.every((function(e){return e.id!==a}))&&r.setCurrentWebTab.call(t,null);var _loop=function(e){i.find((function(t){return t.id===e}))||delete m.O3[e]};for(var s of Object.getOwnPropertyNames(m.O3))_loop(s);r.buildWebTabs.call(t,{data:i})})),r.setPinnedTab=(0,n.q0)((function(e,t,n){r.setWebTabData.call(t,{id:n.id,isPinned:n.pinned,timestamp:Date.now()}),r.refreshTabs.call(t)})),r.syncBookmark=(0,n.q0)((function(e,t,o){var a=e((0,n.GW)());a&&Object.entries(a).forEach((function([,e]){e.url===o.url&&r.setWebTabData.call(t,{id:e.id,isBookmark:o.isBookmark})}))})),r.getBookmarkData=(0,n.q0)((0,o.A)((function*(){var e;return null!=(e=(yield f.A.simpleDb.browserBookmarks.getRawData())?.data)?e:[]}))),r.buildBookmarkData=(0,n.q0)((function(e,t,r){if(!Array.isArray(r))throw new Error("buildBookmarkData: payload must be an array");f.A.simpleDb.browserBookmarks.setRawData({data:r})})),r.addBrowserBookmark=(0,n.q0)((a=(0,o.A)((function*(e,t,n){if(n.url&&n.url!==D.url){var o=[...(yield r.getBookmarkData.call(t)).filter((function(e){return e.url!==n.url})),{url:n.url,title:n.title}];r.buildBookmarkData.call(t,o),r.syncBookmark.call(t,{url:n.url,isBookmark:!0}),f.A.serviceCloudBackup.requestAutoBackup()}})),function(e,t,r){return a.apply(this,arguments)})),r.removeBrowserBookmark=(0,n.q0)((i=(0,o.A)((function*(e,t,n){var o=(yield r.getBookmarkData.call(t)).filter((function(e){return e.url!==n}));r.buildBookmarkData.call(t,o),r.syncBookmark.call(t,{url:n,isBookmark:!1})})),function(e,t,r){return i.apply(this,arguments)})),r.modifyBrowserBookmark=(0,n.q0)((c=(0,o.A)((function*(e,t,n){if(n.url&&n.url!==D.url){var o=(yield r.getBookmarkData.call(t)).map((function(e){return e.url===n.url?_objectSpread(_objectSpread({},e),n):e}));r.buildBookmarkData.call(t,o)}})),function(e,t,r){return c.apply(this,arguments)})),r.getHistoryData=(0,n.q0)((0,o.A)((function*(){var e;return null!=(e=(yield f.A.simpleDb.browserHistory.getRawData())?.data)?e:[]}))),r.buildHistoryData=(0,n.q0)((function(e,t,r){if(!Array.isArray(r))throw new Error("buildHistoryData: payload must be an array");f.A.simpleDb.browserHistory.setRawData({data:r})})),r.addBrowserHistory=(0,n.q0)((l=(0,o.A)((function*(e,t,n){if(n.url&&n.url!==D.url){var o=(yield r.getHistoryData.call(t)).filter((function(e){return e.url!==n.url})),a={id:(0,k.lk)(),url:n.url,title:n.title,createdAt:Date.now()};r.buildHistoryData.call(t,[a,...o])}})),function(e,t,r){return l.apply(this,arguments)})),r.removeBrowserHistory=(0,n.q0)((u=(0,o.A)((function*(e,t,n){var o=(yield r.getHistoryData.call(t)).filter((function(e){return e.id!==n}));r.buildHistoryData.call(t,o)})),function(e,t,r){return u.apply(this,arguments)})),r.removeAllBrowserHistory=(0,n.q0)((d=(0,o.A)((function*(e,t){r.buildHistoryData.call(t,[])})),function(e,t){return d.apply(this,arguments)})),r.getWebTabById=(0,n.q0)((function(e,t,r){var o=e((0,n.GW)());return o?.[r||""]})),r.gotoSite=(0,n.q0)((b=(0,o.A)((function*(e,t,{id:n,url:o,title:a,favicon:i,isNewWindow:s,isInPlace:c,userTriggered:l}){var u=r.getWebTabById.call(t,null!=n?n:"");if(o){var d=v.Ay.validateUrl(o);if(!d)return;if(l&&r.addBrowserHistory.call(t,{url:d,title:null!=a?a:""}),"StandardBrowser"===m.n5)return(0,y.C)(d);var b=u?.id,p=!d.startsWith("http")&&"about:blank"!==d,f="boolean"==typeof s?s:(s||!b||"home"===b||p)&&"MultiTabBrowser"===m.n5,g=yield r.getBookmarkData.call(t),h=g?.some((function(e){return e.url.includes(d)}));return f?r.addWebTab.call(t,{title:a,url:d,favicon:i,isBookmark:h}):r.setWebTabData.call(t,{id:b,url:d,title:a,favicon:i,isBookmark:h}),f||c||(0,m.T0)({url:d,tabId:b}),p&&"MultiTabBrowser"===m.n5&&b&&setTimeout((function(){r.closeWebTab.call(t,b)}),1e3),!0}return!1})),function(e,t,r){return b.apply(this,arguments)})),r.openMatchDApp=(0,n.q0)((h=(0,o.A)((function*(e,t,{dApp:n,webSite:o,isNewWindow:a,tabId:i}){return o?r.gotoSite.call(t,{id:i,url:o.url,title:o.title,favicon:yield f.A.serviceDiscovery.buildWebsiteIconUrl(o.url),isNewWindow:a,userTriggered:!0}):n?r.gotoSite.call(t,{id:i,url:n.url,title:n.name,dAppId:n.dappId,favicon:n.logo||n.originLogo,userTriggered:!0,isNewWindow:a}):void 0})),function(e,t,r){return h.apply(this,arguments)})),r.handleOpenWebSite=(0,n.q0)((function(e,t,{useCurrentWindow:o,tabId:a,navigation:i,webSite:s,dApp:c,shouldPopNavigation:l=!0}){var u=!o;if(!o&&e((0,n.$D)()))return void p.Toast.message({title:S.a.intl.formatMessage({id:"msg__tab_has_reached_the_maximum_limit_of_str"},{0:"20"})});r.setDisplayHomePage.call(t,!1),r.openMatchDApp.call(t,{webSite:s,dApp:c,isNewWindow:u,tabId:a}),l&&i.pop()})),r.onNavigation=(0,n.q0)((function(e,t,{url:o,isNewWindow:a,isInPlace:i,title:s,favicon:c,canGoBack:l,canGoForward:u,loading:d,id:b,handlePhishingUrl:p}){var f=Date.now(),h=r.getWebTabById.call(t,null!=b?b:"");if(h){var y="string"==typeof o&&o!==h.url;if(o){var m=e((0,n.RY)()),{action:S}=v.Ay.parseDappRedirect(o,Array.from(m.keys()));if(S===v.Ay.EDAppOpenActionEnum.DENY)return void p?.(o);if(v.Ay.isValidDeepLink(o))return void(0,g.q)({url:o})}if(y){if(h.timestamp&&f-h.timestamp<500)return;if(j[h.id]&&o!==D.url&&f-j[h.id]<1e3)return;r.gotoSite.call(t,{url:o,title:s,favicon:c,isNewWindow:a,isInPlace:i,id:h.id})}r.setWebTabData.call(t,{id:h.id,title:s,favicon:c,canGoBack:l,canGoForward:u,loading:d})}})),r.addUrlToPhishingCache=(0,n.q0)((function(e,t,r){try{var{origin:o}=new URL(r.url),a=e((0,n.RY)());a.set(o,!0),t((0,n.RY)(),a),window.desktopApi?.setAllowedPhishingUrls(Array.from(a.keys()))}catch{}})),r.updateDappActivityInteraction=(0,n.q0)((function(e,t,r){var o=r.id;o||(o=e((0,n.WL)()));var a=o?m.O3[o]:null;if(a){var i="pause"===r.type;i?m.ay:m.F;a.jsBridge&&(a.jsBridge.globalOnMessageEnabled=!i)}})),r.pauseDappInteraction=(0,n.q0)((function(e,t,n){r.updateDappActivityInteraction.call(t,{id:n,type:"pause"})})),r.resumeDappInteraction=(0,n.q0)((function(e,t,n){r.updateDappActivityInteraction.call(t,{id:n,type:"resume"})})),r.validateWebviewSrc=(0,n.q0)((function(e,t,r){if(!r)return x.InvalidUrl;if(r===$)return x.Valid;var o=e((0,n.RY)()),{action:a}=v.Ay.parseDappRedirect(r,Array.from(o.keys()));return a===v.Ay.EDAppOpenActionEnum.DENY?x.NotSupportProtocol:v.Ay.containsPunycode(r)?x.InvalidPunycode:v.Ay.isValidDeepLink(r)?x.ValidDeeplink:x.Valid})),r}return(0,c.A)(ContextJotaiActionsDiscovery)}(h.x),O=(0,w.j)((function(){return console.log("new ContextJotaiActionsDiscovery()",Date.now()),new A}));function useBrowserTabActions(){var e=O(),t=e.addWebTab.use(),r=e.addBlankWebTab.use(),n=e.buildWebTabs.use(),o=e.refreshTabs.use(),a=e.setWebTabData.use(),i=e.getWebTabById.use(),s=e.closeWebTab.use(),c=e.closeAllWebTabs.use(),l=e.setCurrentWebTab.use(),u=e.setPinnedTab.use(),d=e.setDisplayHomePage.use();return(0,b.useRef)({addWebTab:t,addBlankWebTab:r,buildWebTabs:n,refreshTabs:o,setWebTabData:a,getWebTabById:i,closeWebTab:s,closeAllWebTabs:c,setCurrentWebTab:l,setPinnedTab:u,setDisplayHomePage:d})}function useBrowserBookmarkAction(){var e=O(),t=e.buildBookmarkData.use(),r=e.getBookmarkData.use(),n=e.addBrowserBookmark.use(),o=e.removeBrowserBookmark.use(),a=e.modifyBrowserBookmark.use();return(0,b.useRef)({buildBookmarkData:t,getBookmarkData:r,addBrowserBookmark:n,removeBrowserBookmark:o,modifyBrowserBookmark:a})}function useBrowserHistoryAction(){var e=O(),t=e.buildHistoryData.use(),r=e.getHistoryData.use(),n=e.addBrowserHistory.use(),o=e.removeBrowserHistory.use(),a=e.removeAllBrowserHistory.use();return(0,b.useRef)({buildHistoryData:t,getHistoryData:r,addBrowserHistory:n,removeBrowserHistory:o,removeAllBrowserHistory:a})}function useBrowserAction(){var e=O(),t=e.gotoSite.use(),r=e.openMatchDApp.use(),n=e.handleOpenWebSite.use(),o=e.onNavigation.use(),a=e.addUrlToPhishingCache.use(),i=e.pauseDappInteraction.use(),s=e.resumeDappInteraction.use(),c=e.validateWebviewSrc.use();return(0,b.useRef)({gotoSite:t,openMatchDApp:r,handleOpenWebSite:n,onNavigation:o,addUrlToPhishingCache:a,pauseDappInteraction:i,resumeDappInteraction:s,validateWebviewSrc:c})}},574319:(e,t,r)=>{r.d(t,{D$:()=>useWebTabDataById,bI:()=>useDisabledAddedNewTab,cf:()=>useActiveTabId,oM:()=>useWebTabs,y:()=>useDisplayHomePageFlag});var n=r(514041),o=r(567967),useWebTabs=function(){var[e]=(0,o.pJ)();return(0,n.useMemo)((function(){return{tabs:e.tabs}}),[e])},useWebTabDataById=function(e){var[t]=(0,o.nD)();return(0,n.useMemo)((function(){return{tab:t[null!=e?e:""]}}),[t,e])},useActiveTabId=function(){var[e]=(0,o.Xp)();return(0,n.useMemo)((function(){return{activeTabId:e}}),[e])},useDisplayHomePageFlag=function(){var[e]=(0,o.Do)();return{displayHomePage:e}},useDisabledAddedNewTab=function(){var[e]=(0,o.AS)();return(0,n.useMemo)((function(){return{disabledAddedNewTab:e}}),[e])}},568144:(e,t,r)=>{r.r(t),r.d(t,{default:()=>V});var n=r(514041),o=r(490343),a=r(498356),i=r(730223),s=r(908867),c=r(663522),l=r(574319),u=r(564452),d=r(831085),b={width:"calc(100vw - 40px)",flex:1,mt:"$4"};const p=(0,u.k)((function CustomHeaderTitle({handleSearchBarPress:e}){var t=(0,s.A)(),r=(0,o.useMedia)(),{activeTabId:n}=(0,l.cf)(),{tab:a}=(0,l.D$)(null!=n?n:""),i=n&&a?.url;return(0,d.jsxs)(o.XStack,{role:"button",alignItems:"center",minWidth:"$64",px:"$2",py:"$1.5",bg:"$bgStrong",borderRadius:"$3",$md:b,hoverStyle:{bg:"$bgHover"},pressStyle:{bg:"$bgActive"},onPress:function(){var t;return e(null!=(t=a?.url)?t:"")},borderCurve:"continuous",children:[(0,d.jsx)(o.Icon,{name:i?"LockOutline":"SearchOutline",size:"$5",color:"$iconSubdued"}),(0,d.jsx)(o.SizableText,{pl:"$2",size:"$bodyLg",color:"$textSubdued",flex:1,numberOfLines:1,testID:"explore-index-search",children:i?a?.url:t.formatMessage({id:"form__search"})}),r.gtMd?(0,d.jsxs)(o.Shortcut,{children:[(0,d.jsx)(o.Shortcut.Key,{children:"âŒ˜"}),(0,d.jsx)(o.Shortcut.Key,{children:"T"})]}):null]})}));var f=r(586330),g=r(728234),h=r(310955),y=r(317522),m=r(911998),S=r(567967),w=r(117746),k=r(503668),v=r.n(k);function Banner({banners:e,handleOpenWebSite:t,isLoading:r}){var a=(0,o.useMedia)(),i=(0,n.useCallback)((function({item:e}){var r;return(0,d.jsxs)(o.Stack,{p:"$5",tag:"section",flex:1,position:"relative",userSelect:"none",onPress:function(){return t({webSite:{url:e.href,title:e.href},useSystemBrowser:e.useSystemBrowser})},children:[(0,d.jsx)(o.Image,{flex:1,borderRadius:"$3",bg:"$bgStrong",src:e.src}),(0,d.jsx)(o.Stack,{position:"absolute",bottom:0,right:0,left:0,px:"$10",py:"$8",$gtMd:{px:"$14",py:"$10"},children:(0,d.jsx)(o.SizableText,{color:"dark"===e.theme?"$textDark":"$textLight",size:"$headingLg",$gtMd:{size:"$heading2xl"},maxWidth:"$96",children:null!=(r=e.title)?r:""})})]})}),[t]),s=(0,n.useCallback)((function({currentIndex:t,goToNextIndex:r,gotToPrevIndex:n}){return(0,d.jsxs)(d.Fragment,{children:[a.gtMd?(0,d.jsxs)(d.Fragment,{children:[0!==t?(0,d.jsx)(o.IconButton,{position:"absolute",left:"$10",top:"50%",transform:"translateY(-50%)",icon:"ChevronLeftOutline",variant:"tertiary",iconProps:{color:"light"===e[t]?.theme?"$iconSubduedLight":"$iconSubduedDark"},onPress:n}):null,t!==e.length-1?(0,d.jsx)(o.IconButton,{icon:"ChevronRightOutline",variant:"tertiary",position:"absolute",right:"$10",top:"50%",transform:"translateY(-50%)",iconProps:{color:"light"===e[t]?.theme?"$iconSubduedLight":"$iconSubduedDark"},onPress:r,disabled:t===e.length-1}):null]}):null,e.length>1?(0,d.jsx)(o.XStack,{space:"$1",position:"absolute",right:"$10",bottom:"$10",children:e.map((function(e,r){return(0,d.jsx)(o.Stack,{w:"$3",$gtMd:{w:"$4"},h:"$1",borderRadius:"$full",bg:"$whiteA12",opacity:t===r?1:.5},r)}))}):null]})}),[a.gtMd,e]),c=(0,n.useCallback)((function(e){return e.bannerId}),[]);return v()(r)||r?(0,d.jsx)(o.Stack,{p:"$5",children:(0,d.jsx)(o.Skeleton,{h:188,w:"100%",$gtMd:{height:268},$gtLg:{height:364}})}):(0,d.jsx)(o.Swiper,{autoplay:!0,autoplayLoop:!0,autoplayLoopKeepAnimation:!0,autoplayDelayMs:3e3,height:228,$gtMd:{height:308},$gtLg:{height:404},keyExtractor:c,data:e,renderItem:i,renderPagination:s})}var x=r(324586),j=r(839850),$=["selected","children"],D=["children"],A=["children"];function ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(r),!0).forEach((function(t){(0,x.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function DashboardSectionHeader(e){var{children:t}=e,r=(0,j.A)(e,A);return(0,d.jsx)(o.XStack,_objectSpread(_objectSpread({alignItems:"center",space:"$5",userSelect:"none",$gtMd:{pt:"$1",mt:"$1",borderTopWidth:1,borderColor:"$borderSubdued"}},r),{},{children:t}))}DashboardSectionHeader.Heading=function SectionHeading(e){var{selected:t,children:r}=e,n=(0,j.A)(e,$);return(0,d.jsx)(o.Heading,_objectSpread(_objectSpread(_objectSpread({size:"$headingLg",selectable:!1,py:"$2.5"},!t&&{opacity:.5}),n),{},{children:r}))},DashboardSectionHeader.Button=function SectionButton(e){var{children:t}=e,r=(0,j.A)(e,D);return(0,d.jsx)(o.Button,_objectSpread(_objectSpread({size:"medium",variant:"tertiary",ml:"auto"},r),{},{children:t}))};var O=["dataSource","handleOpenWebSite"];function BookmarksAndHistoriesSection_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function BookmarksAndHistoriesSection_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?BookmarksAndHistoriesSection_ownKeys(Object(r),!0).forEach((function(t){(0,x.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BookmarksAndHistoriesSection_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Items(e){var{dataSource:t,handleOpenWebSite:r}=e,a=(0,j.A)(e,O),[i,s]=(0,n.useState)(0),c=(0,o.useMedia)();return(0,n.useEffect)((function(){s(c.gtXl?8:c.gtLg?6:c.gtSm?5:4)}),[c.gtXl,c.gtLg,c.gtSm,c.gtMd]),(0,d.jsx)(o.XStack,BookmarksAndHistoriesSection_objectSpread(BookmarksAndHistoriesSection_objectSpread({flexWrap:"wrap",mx:"$-5",$gtLg:{mx:"$-3"}},a),{},{children:t.slice(0,i).map((function({logo:e,title:t,url:n},a){return(0,d.jsxs)(o.Stack,{flexBasis:"25%",alignItems:"center",space:"$2",py:"$2",$gtSm:{flexBasis:"20%"},$gtLg:{p:"$3",flexBasis:"33.3333%",flexDirection:"row",space:"$5"},$gtXl:{flexBasis:"25%"},userSelect:"none",onPress:function(){return r({webSite:{url:n,title:t}})},children:[(0,d.jsxs)(o.Image,{size:"$14",borderRadius:"$3",$gtLg:{w:"$12",h:"$12"},children:[(0,d.jsx)(o.Image.Source,{source:{uri:e}}),(0,d.jsx)(o.Image.Fallback,{children:(0,d.jsx)(o.Icon,{size:"$14",$gtLg:{size:"$12"},name:"GlobusOutline"})}),(0,d.jsx)(o.Image.Loading,{children:(0,d.jsx)(o.Skeleton,{width:"100%",height:"100%"})})]}),(0,d.jsx)(o.SizableText,{size:"$bodyLgMedium",px:"$2",$gtMd:{size:"$bodyMdMedium",px:"$0"},textAlign:"center",numberOfLines:1,children:t})]},a)}))}))}function BookmarksAndHistoriesSection({bookmarksData:e,historiesData:t,onPressMore:r,handleOpenWebSite:a}){var[i,s]=(0,n.useState)(!1),c=(0,n.useMemo)((function(){return i?null!=t?t:[]:null!=e?e:[]}),[t,e,i]),l=i?v()(t):v()(e);return(0,d.jsxs)(o.Stack,{px:"$5",minHeight:"$40",children:[(0,d.jsxs)(DashboardSectionHeader,{children:[(0,d.jsx)(DashboardSectionHeader.Heading,{selected:!i,onPress:function(){return s(!1)},children:"Bookmarks"}),(0,d.jsx)(DashboardSectionHeader.Heading,{selected:i,onPress:function(){return s(!0)},children:"History"}),c.length>0?(0,d.jsx)(DashboardSectionHeader.Button,{onPress:function(){r(i)},children:"See All"}):null]}),c.length>0?(0,d.jsx)(Items,{dataSource:c,handleOpenWebSite:a}):(0,d.jsx)(o.Stack,{bg:"$bgSubdued",py:"$6",flex:1,borderRadius:"$3",borderCurve:"continuous",justifyContent:"center",children:l?(0,d.jsx)(o.Skeleton,{w:"100%"}):(0,d.jsx)(o.SizableText,{size:"$bodyLg",color:"$textDisabled",textAlign:"center",children:i?"No History Yet":"No Bookmarks Yet"})})]})}var B=r(848312),W=r(344145),I=r.n(W),P=r(812715),C=r(584186),T=["children","horizontal"];function ChunkedItemsView_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ChunkedItemsView_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ChunkedItemsView_ownKeys(Object(r),!0).forEach((function(t){(0,x.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ChunkedItemsView_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var chunkArray=function(e,t){for(var r=[],n=0;n<e.length;n+=t)r.push(e.slice(n,n+t));return r},H=I()((function(){return(0,o.getTokenValue)("$12","size")}),{maxAge:C.A.getTimeDurationMs({minute:10})});function useCardWidth(){var{width:e}=(0,P.A)();return e-H()}function ItemsContainer(e){var{children:t,horizontal:r}=e,n=(0,j.A)(e,T),a=(0,o.useMedia)(),i=function usePaginationStyle(e){var t=useCardWidth(),r=H();return e?{horizontal:!0,showsHorizontalScrollIndicator:!1,decelerationRate:0,snapToInterval:t,snapToAlignment:"start",contentContainerStyle:{paddingRight:r}}:void 0}(!!r);return a.gtMd?(0,d.jsx)(o.Stack,ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({},n),{},{children:t})):(0,d.jsx)(o.ScrollView,ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({pagingEnabled:!0},i),n),{},{contentContainerStyle:ChunkedItemsView_objectSpread(ChunkedItemsView_objectSpread({},n.contentContainerStyle),i?.contentContainerStyle),children:t}))}function ChunkedItemsView({isExploreView:e,dataChunks:t,handleOpenWebSite:r}){var n=useCardWidth();return(0,d.jsx)(ItemsContainer,{mx:"$-5",$md:c.Ay.isRuntimeBrowser?{ml:"$-3"}:void 0,horizontal:!e,contentContainerStyle:{px:"$2",$md:{flexDirection:e?"column":"row"},$gtMd:{flexDirection:"column"}},children:t.map((function(t,a){return(0,d.jsx)(o.Stack,{$md:e?{flexDirection:"row",flexWrap:"wrap"}:{w:n},$gtMd:{flexDirection:"row",flexWrap:"wrap"},children:t.map((function(t){return(0,d.jsxs)(o.XStack,{p:"$3",alignItems:"center",$md:e?{flexBasis:"100%"}:void 0,$gtMd:{px:"$5",flexBasis:"50%"},$gtLg:{px:"$5",flexBasis:"33.3333%"},onPress:function(){return r({webSite:{url:t.url,title:t.name}})},testID:`dapp-${t.dappId}`,children:[(0,d.jsx)(o.Image,{w:"$14",h:"$14",borderRadius:"$3",children:(0,d.jsx)(o.Image.Source,{source:{uri:t.logo}})}),(0,d.jsxs)(o.Stack,{flex:1,ml:"$3",children:[(0,d.jsxs)(o.XStack,{alignItems:"center",children:[(0,d.jsx)(o.SizableText,{size:"$bodyLgMedium",$gtMd:{size:"$bodyMdMedium"},numberOfLines:1,children:t.name}),Array.isArray(t.tags)&&t.tags.length?(0,d.jsx)(o.Badge,{badgeSize:"sm",badgeType:t.tags[0].type,ml:"$2",children:t.tags[0].name}):null]}),(0,d.jsx)(o.SizableText,{size:"$bodyMd",color:"$textSubdued",numberOfLines:1,$gtMd:{size:"$bodySm",numberOfLines:2,whiteSpace:"break-spaces"},children:t.description})]})]},t.dappId)}))},a)}))})}function ChunkedItemsSkeletonView({isExploreView:e,dataChunks:t}){var r=useCardWidth();return(0,d.jsx)(ItemsContainer,{mx:"$-5",horizontal:!e,contentContainerStyle:{px:"$2",$md:{flexDirection:e?"column":"row"},$gtMd:{flexDirection:"column"}},children:t?.map((function(t,n){return(0,d.jsx)(o.Stack,{$md:e?{flexDirection:"row",flexWrap:"wrap"}:{w:r},$gtMd:{flexDirection:"row",flexWrap:"wrap"},children:t.map((function(t){return(0,d.jsxs)(o.XStack,{p:"$3",space:"$3",alignItems:"center",$md:e?{flexBasis:"100%"}:void 0,$gtMd:{flexBasis:"50%"},$gtLg:{flexBasis:"33.3333%"},children:[(0,d.jsx)(o.Skeleton,{w:"$14",h:"$14",borderRadius:"$3"}),(0,d.jsxs)(o.Stack,{flex:1,space:"$1",children:[(0,d.jsx)(o.XStack,{alignItems:"center",children:(0,d.jsx)(o.Skeleton,{w:"$20",h:"$4"})}),(0,d.jsx)(o.Skeleton,{w:216,h:"$4",$md:{w:"100%"}})]})]},t.dappId)}))},n)}))})}var M=r(86677),L=r(885127);function ExploreView({isLoading:e,dAppList:t,categoryResult:r,handleOpenWebSite:a,selectedCategory:i,setSelectedCategory:s,selectedNetwork:c,setSelectedNetwork:l,networkList:u}){var b,p,f=(0,o.useMedia)(),g=(0,n.useMemo)((function(){return f.gtMd?f.lg?2:3:1}),[f]),h=(0,n.useMemo)((function(){return Array.isArray(r?.categoryList)?r.categoryList.map((function(e){return{value:e.categoryId,label:e.name}})):[]}),[r?.categoryList]),y=!t?.data||0===t?.data.length,m=(0,n.useCallback)((function(e,t){return(0,d.jsx)(ChunkedItemsView,{isExploreView:!0,dataChunks:e,handleOpenWebSite:a},t)}),[a]),S=(0,n.useCallback)((function(e,t){return(0,d.jsx)(ChunkedItemsSkeletonView,{isExploreView:!0,dataChunks:e},t)}),[]),w=(0,n.useMemo)((function(){var r;return y?(0,d.jsx)(o.Empty,{icon:"SearchOutline",title:"No Results"}):e?S(chunkArray(Array.from({length:30}).map((function(e,t){return{dappId:t.toString()}})),g),i):m(chunkArray(null!=(r=t?.data)?r:[],g),i)}),[y,e,t?.data,g,i,S,m]),k=(0,L.A)();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(o.XStack,{py:"$2",children:[(0,d.jsx)(o.Select,{title:"Categories",items:h,value:i,onChange:s,renderTrigger:function({label:e}){return(0,d.jsxs)(o.XStack,{mr:"$2.5",py:"$1.5",px:"$2",bg:"$bgStrong",borderRadius:"$3",userSelect:"none",borderCurve:"continuous",hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},children:[(0,d.jsx)(o.SizableText,{size:"$bodyMdMedium",px:"$1",children:e}),(0,d.jsx)(o.Icon,{name:"ChevronDownSmallOutline",size:"$5",color:"$iconSubdued"})]})}}),(0,d.jsxs)(o.XStack,{py:"$1.5",px:"$2",bg:"$bgStrong",borderRadius:"$3",userSelect:"none",borderCurve:"continuous",hoverStyle:{bg:"$bgStrongHover"},pressStyle:{bg:"$bgStrongActive"},onPress:function(){k({onSelect:function(e){e&&(console.log("=====>",e),l(e))},defaultNetworkId:c?.id,networkIds:u})},children:[(0,d.jsx)(o.Image,{w:"$5",h:"$5",children:(0,d.jsx)(M.b,{source:{uri:null!=(b=c?.logoURI)?b:""}})}),(0,d.jsx)(o.XStack,{maxWidth:119,children:(0,d.jsx)(o.SizableText,{size:"$bodyMdMedium",px:"$1",numberOfLines:1,children:null!=(p=c?.name)?p:""})}),(0,d.jsx)(o.Icon,{name:"ChevronDownSmallOutline",size:"$5",color:"$iconSubdued"})]})]}),w]})}function SuggestedView_ownKeys(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function SuggestedView_objectSpread(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?SuggestedView_ownKeys(Object(r),!0).forEach((function(t){(0,x.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SuggestedView_ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function SuggestedView({suggestedData:e,handleOpenWebSite:t}){var r=(0,o.useMedia)(),a=r.gtMd&&r.lg?2:3,i=(0,n.useMemo)((function(){return e.map((function(e){return SuggestedView_objectSpread(SuggestedView_objectSpread({},e),{},{dataChunks:chunkArray(e.dapps,a)})}))}),[e,a]),s=(0,n.useCallback)((function(e,r){return(0,d.jsx)(ChunkedItemsView,{isExploreView:!1,dataChunks:e,handleOpenWebSite:t},r)}),[t]);return(0,d.jsx)(d.Fragment,{children:i.map((function(e,t){return(0,d.jsxs)(o.Stack,{children:[(0,d.jsx)(o.Heading,SuggestedView_objectSpread(SuggestedView_objectSpread({size:"$headingMd",pt:"$2",selectable:!1},0!==t&&{pt:"$5"}),{},{children:e.name})),s(e.dataChunks,e.categoryId)]},`${e.name}--${e.categoryId}`)}))})}function SuggestedAndExploreSection({suggestedData:e,handleOpenWebSite:t,isLoading:r}){var[a,i]=(0,n.useState)(!1),[s,c]=(0,n.useState)(""),[l,u]=(0,n.useState)(),{result:b}=(0,m.yk)((0,f.A)((function*(){var[e,t,r]=yield Promise.all([h.A.serviceDiscovery.fetchCategoryList(),h.A.serviceNetwork.getNetwork({networkId:(0,B.V$)().eth}),h.A.serviceNetwork.getAllNetworks()]),n=r.networks.filter((function(e){return!e.isTestnet})).map((function(e){return e.id}));return c(e[0].categoryId),u(t),{categoryList:e,networkList:n}})),[]),{result:p,isLoading:g}=(0,m.yk)((0,f.A)((function*(){return s&&l?h.A.serviceDiscovery.fetchDAppListByCategory({category:s,network:l.id}):{data:[],next:""}})),[s,l],{watchLoading:!0}),y=(0,o.useMedia)(),S=y.gtMd&&y.lg?2:3,w=(0,n.useCallback)((function(){return(0,d.jsx)(o.Stack,{space:"$5",children:Array.from({length:4}).map((function(e,t){return(0,d.jsxs)(o.Stack,{space:"$3",children:[(0,d.jsx)(o.Skeleton,{w:"$14",h:"$6"}),(0,d.jsx)(ChunkedItemsSkeletonView,{isExploreView:!0,dataChunks:chunkArray(Array.from({length:S}).map((function(e,t){return{dappId:`first-${t}`}})),S)},"skeleton-view")]},t)}))})}),[S]),k=(0,n.useCallback)((function(){return v()(r)||r?w():a?(0,d.jsx)(ExploreView,{isLoading:g,dAppList:p,categoryResult:b,selectedCategory:s,selectedNetwork:l,setSelectedCategory:c,setSelectedNetwork:u,networkList:null!=(n=b?.networkList)?n:[],handleOpenWebSite:t}):(0,d.jsx)(SuggestedView,{suggestedData:e,handleOpenWebSite:t});var n}),[g,a,r,w,e,t,p,b,s,l,c,u]);return(0,d.jsxs)(o.Stack,{p:"$5","$platform-native":{pb:"$16"},tag:"section",children:[(0,d.jsxs)(DashboardSectionHeader,{children:[(0,d.jsx)(DashboardSectionHeader.Heading,{selected:!a,onPress:function(){return i(!1)},children:"Suggested"},"suggested"),(0,d.jsx)(DashboardSectionHeader.Heading,{selected:a,onPress:function(){return i(!0)},children:"Explore"},"explore")]}),k()]})}const _=(0,n.memo)((function DashboardContent({onScroll:e}){var t=(0,a.A)(),{displayHomePage:r}=((0,g.jH)(),(0,l.y)()),{handleOpenWebSite:s}=(0,S.yZ)().current,{result:[c,u]=[],run:b}=(0,m.yk)((0,f.A)((function*(){var e=h.A.serviceDiscovery.getBookmarkData({generateIcon:!0,sliceCount:8}),t=h.A.serviceDiscovery.getHistoryData({generateIcon:!0,sliceCount:8});return Promise.all([e,t])})),[],{watchLoading:!0}),{result:p,isLoading:k}=(0,m.yk)((0,f.A)((function*(){return yield h.A.serviceDiscovery.fetchDiscoveryHomePageData()})),[],{watchLoading:!0});(0,y.A)(i.V4.Discovery,(function(e){e&&setTimeout((function(){b()}))})),(0,n.useEffect)((function(){0}),[r,b]);var v=(0,n.useCallback)((function(e){t.pushModal(i.ry.DiscoveryModal,{screen:e?i.v1.HistoryListModal:i.v1.BookmarkListModal})}),[t]),x=(0,n.useMemo)((function(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Banner,{banners:Array.isArray(p?.banners)?p?.banners:[],handleOpenWebSite:function({webSite:e,useSystemBrowser:r}){r&&e?.url?(0,w.Dr)(e.url):e?.url&&s({webSite:e,navigation:t,shouldPopNavigation:!1})},isLoading:k},"Banner"),(0,d.jsx)(BookmarksAndHistoriesSection,{bookmarksData:c,historiesData:u,onPressMore:v,handleOpenWebSite:function({webSite:e}){return s({webSite:e,navigation:t,shouldPopNavigation:!1})}},"BookmarksAndHistoriesSection"),(0,d.jsx)(SuggestedAndExploreSection,{suggestedData:Array.isArray(p?.categories)?p.categories:[],handleOpenWebSite:function({webSite:e}){return s({webSite:e,navigation:t,shouldPopNavigation:!1})},isLoading:k},"SuggestedAndExploreSection")]})}),[c,u,v,s,t,p,k]);return(0,d.jsx)(o.Stack,{children:x})}));const V=(0,u.k)((function Dashboard(){var e=(0,a.A)(),t=(0,n.useCallback)((function(){e.pushModal(i.ry.DiscoveryModal,{screen:i.v1.SearchModal})}),[e]),r=(0,n.useCallback)((function(){return(0,d.jsx)(p,{handleSearchBarPress:t})}),[t]);return(0,d.jsxs)(o.Page,{scrollEnabled:!0,children:[(0,d.jsx)(o.Page.Header,{headerTitle:r}),(0,d.jsx)(o.Page.Body,{children:(0,d.jsx)(_,{})})]})}))},660015:(e,t,r)=>{r.d(t,{F:()=>s,O3:()=>a,T0:()=>crossWebviewLoadUrl,ay:()=>i,n5:()=>o});var n=r(663522),o="StandardBrowser",a={};function getWebviewWrapperRef(e){var t=e?a[e]:null;return null!=t?t:null}function crossWebviewLoadUrl({url:e,tabId:t}){var r=getWebviewWrapperRef(t);console.log("crossWebviewLoadUrl >>>>",e),n.Ay.isRuntimeBrowser?r?.innerRef?.loadURL(e):r?.innerRef?.loadUrl(e)}var i="\n(function(){\n  if (window.WebSocket) {\n    if (!window.$$onekeyWebSocketSend) {\n      window.$$onekeyWebSocketSend = window.WebSocket.prototype.send;\n    }\n    window.WebSocket.prototype.send = () => {};\n  }\n})()\n",s="\n(function(){\n  if (\n    window.WebSocket &&\n    window.$$onekeyWebSocketSend\n  ) {\n    window.WebSocket.prototype.send = window.$$onekeyWebSocketSend;\n  }\n})()\n"}}]);