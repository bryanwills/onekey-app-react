"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[39316],{326745:(e,t,n)=>{n.d(t,{u:()=>useAppRoute});var o=n(728234);function useAppRoute(){return(0,o.lq)()}},188392:(e,t,n)=>{n.d(t,{d:()=>LidoWithdraw});var o=n(586330),i=n(514041),r=n(241440),a=n(490343),c=n(88803),s=n(791088),l=n(391944),u=n(734809),d=n(827843),p=n(831085),LidoWithdraw=function({balance:e,price:t,tokenImageUri:n,tokenSymbol:m,receivingTokenSymbol:f,minAmount:b="0",rate:k="1",onConfirm:y}){var[S,g]=(0,i.useState)(!1),[h,x]=(0,i.useState)(""),[{currencyInfo:{symbol:j}}]=(0,u.useSettingsPersistAtom)(),v=(0,i.useCallback)((0,o.A)((function*(){try{g(!0),yield y?.(h)}finally{g(!1)}})),[h,y]),I=(0,i.useCallback)((function(e){new r.A(e).isNaN()?""===e&&x(""):x(e)}),[]),w=(0,i.useMemo)((function(){var e=new r.A(h);if(!e.isNaN())return e.multipliedBy(t).toFixed()}),[h,t]),A=(0,i.useMemo)((function(){return new r.A(h).gt(e)}),[h,e]),P=(0,i.useMemo)((function(){var e=new r.A(b),t=new r.A(h);return!(!e.isGreaterThan(0)||!t.isGreaterThan(0))&&t.isLessThan(e)}),[b,h]),T=(0,i.useCallback)((function(){I(e)}),[I,e]),C=(0,i.useMemo)((function(){return(0,r.A)(h).isNaN()||A||P}),[h,A,P]),O=(0,i.useMemo)((function(){var e=(0,r.A)(h);if(e.isNaN())return null;var n=e.dividedBy(k).toFixed(),o=e.multipliedBy(t).dividedBy(k).toFixed();return(0,p.jsx)(a.XStack,{space:"$1",children:(0,p.jsxs)(a.SizableText,{children:[(0,p.jsx)(a.NumberSizeableText,{formatter:"balance",formatterOptions:{tokenSymbol:f},children:n}),"(",(0,p.jsx)(a.NumberSizeableText,{formatter:"value",formatterOptions:{currency:j},children:o}),")"]})})}),[h,t,j,f,k]);return(0,p.jsxs)(a.Page,{children:[(0,p.jsx)(a.Page.Header,{title:"Redeem"}),(0,p.jsx)(a.Page.Body,{children:(0,p.jsxs)(a.YStack,{children:[(0,p.jsxs)(a.Stack,{mx:"$2",px:"$3",space:"$5",children:[(0,p.jsx)(c.J,{hasError:A||P,value:h,onChange:I,tokenSelectorTriggerProps:{selectedTokenImageUri:n,selectedTokenSymbol:m},inputProps:{placeholder:"0"},balanceProps:{value:e,onPress:T},valueProps:{value:w,currency:w?j:void 0},enableMaxAmount:!0}),(0,p.jsxs)(a.YStack,{space:"$1",children:[P?(0,p.jsx)(a.Alert,{icon:"InfoCircleOutline",type:"critical",title:`The minimum amount for this staking is ${b} ${m}.`}):null,A?(0,p.jsx)(a.Alert,{icon:"InfoCircleOutline",type:"critical",title:"Insufficient balance."}):null]})]}),(0,p.jsxs)(a.YStack,{children:[O?(0,p.jsx)(s.c,{title:"Receive",titleProps:{color:"$textSubdued"},children:O}):null,h?(0,p.jsx)(s.c,{title:"Pay with",titleProps:{color:"$textSubdued"},children:(0,p.jsx)(a.SizableText,{children:(0,p.jsx)(a.NumberSizeableText,{formatter:"balance",formatterOptions:{tokenSymbol:m},children:h})})}):null,(0,p.jsx)(s.c,{title:"Protocol",titleProps:{color:"$textSubdued"},children:(0,p.jsxs)(a.XStack,{space:"$2",alignItems:"center",children:[(0,p.jsx)(l.o,{size:"sm",tokenImageUri:d.a3}),(0,p.jsx)(a.SizableText,{size:"$bodyMdMedium",children:"Lido"})]})}),(0,p.jsx)(s.c,{title:"Stake Release Period",titleProps:{color:"$textSubdued"},children:(0,p.jsx)(s.c.Text,{primary:"< 4 Days"})})]})]})}),(0,p.jsx)(a.Page.Footer,{onConfirmText:"Redeem",confirmButtonProps:{onPress:v,loading:S,disabled:C}})]})}},918778:(e,t,n)=>{n.d(t,{Kb:()=>useLidoMaticStake,Yv:()=>useLidoMaticClaim,ws:()=>useLidoMaticWithdraw});var o=n(324586),i=n(586330),r=n(514041),a=n(310955),c=n(927799);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useLidoMaticStake({accountId:e,networkId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:e,networkId:t});return(0,r.useCallback)((n=(0,i.A)((function*({amount:n,stakingInfo:i,onSuccess:r,onFail:c}){var s=yield a.A.serviceAccount.getAccount({accountId:e,networkId:t}),l=yield a.A.serviceStaking.buildLidoMaticStakingTransaction({amount:n,networkId:t});yield o({encodedTx:_objectSpread(_objectSpread({},l),{},{from:s.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[o,e,t])}function useLidoMaticWithdraw({accountId:e,networkId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:e,networkId:t});return(0,r.useCallback)((n=(0,i.A)((function*({amount:n,stakingInfo:i,onSuccess:r,onFail:c}){var s=yield a.A.serviceAccount.getAccount({accountId:e,networkId:t}),l=yield a.A.serviceStaking.buildLidoMaticWithdrawalTransaction({amount:n,networkId:t});yield o({encodedTx:_objectSpread(_objectSpread({},l),{},{from:s.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[e,t,o])}function useLidoMaticClaim({accountId:e,networkId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:e,networkId:t});return(0,r.useCallback)((n=(0,i.A)((function*({tokenId:n,stakingInfo:i,onSuccess:r,onFail:c}){var s=yield a.A.serviceAccount.getAccount({accountId:e,networkId:t}),l=yield a.A.serviceStaking.buildLidoMaticClaimTransaction({tokenId:n,networkId:t});yield o({encodedTx:_objectSpread(_objectSpread({},l),{},{from:s.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[o,e,t])}},539316:(e,t,n)=>{n.r(t),n.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var o=n(586330),i=n(514041),r=n(241440),a=n(498356),c=n(326745),s=n(188392),l=n(918778),u=n(827843),d=n(831085);const __WEBPACK_DEFAULT_EXPORT__=function(){var e,t=(0,c.u)(),{accountId:n,networkId:p,balance:m,token:f,price:b,receivingToken:k,rate:y}=t.params,S=(0,a.A)(),g=(0,l.ws)({accountId:n,networkId:p}),h=(0,i.useCallback)((e=(0,o.A)((function*(e){var t=(0,r.A)(e).shiftedBy(f.decimals).toFixed(0);yield g({amount:t,stakingInfo:{protocol:"lido",send:{amount:e,token:f},tags:["lido-matic"]},onSuccess:function(){return S.pop()}})})),function(t){return e.apply(this,arguments)}),[f,g,S]);return(0,d.jsx)(s.d,{receivingTokenSymbol:k.symbol,price:b,balance:m,tokenSymbol:f.symbol,tokenImageUri:u.LN,onConfirm:h,rate:y})}},827843:(e,t,n)=>{n.d(t,{$e:()=>a,Cp:()=>i,LN:()=>r,a3:()=>o});var o="https://uni.onekey-asset.com/static/logo/Lido.png",i="https://uni.onekey-asset.com/static/chain/eth.png",r="https://uni.onekey-asset.com/static/chain/polygon.png",a="https://lido.fi/"}}]);