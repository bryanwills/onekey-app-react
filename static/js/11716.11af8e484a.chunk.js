"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[11716],{940916:(e,r,t)=>{t.d(r,{G:()=>l});var n=t(482451),i=t.n(n),u=t(324586),o=t(586330),a=t(230414),s=t(507140),c=t(606777),P=t(554902),O=t(180556),f=t(929296),_=t(195309),p=t(972715),d=t(901048).Buffer;function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,p.A)(e);if(r){var i=(0,p.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,_.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var h=function(e){(0,f.A)(ChainSigner,e);var r=_createSuper(ChainSigner);function ChainSigner(e,t,n){var i,u=(0,P.N)(n,{key:e,chainCode:d.alloc(32)},t).key.toString("hex");return(i=r.call(this,u,n)).encryptedPrivateKey=e,i.password=t,i.curve=n,i}var t,n=ChainSigner.prototype;return n.getPrvkey=function getPrvkey(){return Promise.resolve((0,P.Yc)(this.password,this.encryptedPrivateKey))},n.getPrvkeyHex=(t=(0,o.A)((function*(){return c.A.bytesToHex(yield this.getPrvkey())})),function getPrvkeyHex(){return t.apply(this,arguments)}),n.sign=function sign(e){var r=(0,P._S)(this.curve,this.encryptedPrivateKey,e,this.password);return"secp256k1"===this.curve?Promise.resolve([r.slice(0,-1),r[r.length-1]]):Promise.resolve([r,0])},(0,a.A)(ChainSigner)}(function(){function Verifier(e,r){this.curve=r,this.compressedPublicKey=d.from(e,"hex"),this.uncompressedPublicKey=(0,P.sA)(r,this.compressedPublicKey)}var e,r=Verifier.prototype;return r.getPubkey=function getPubkey(e){return Promise.resolve(e?this.compressedPublicKey:this.uncompressedPublicKey)},r.getPubkeyHex=(e=(0,o.A)((function*(e){return c.A.bytesToHex(yield this.getPubkey(e))})),function getPubkeyHex(r){return e.apply(this,arguments)}),r.verify=function verify(){return Promise.resolve(d.from([]))},r.verifySignature=function verifySignature({publicKey:e,digest:r,signature:t}){var n=c.A.toBuffer(e),i=c.A.toBuffer(r),u=c.A.toBuffer(t),{curve:o}=this,a=(0,P.MX)(o,n,i,u);return Promise.resolve(a)},(0,a.A)(Verifier)}());function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,u.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var l=function(){function CoreChainApiBase(){}var e,r,t,n,u,f=CoreChainApiBase.prototype;return f.baseGetCurve=function baseGetCurve(e){switch(e){case"ed25519":return P.ev;case"secp256k1":return P.bI;case"nistp256":return P.OX;default:throw new s.He("Unsupported curve")}},f.baseCreateSigner=(e=(0,o.A)((function*({curve:e,privateKey:r,password:t}){if(void 0===t)throw new s.He("Software signing requires a password.");var n=c.A.toBuffer(r);return Promise.resolve(new h(n,t,e))})),function baseCreateSigner(r){return e.apply(this,arguments)}),f.baseGetSingleSigner=(r=(0,o.A)((function*({payload:e,curve:r}){var t=yield this.getPrivateKeys(e),n=e.account.path,i=t[n],u=e.account.relPaths?.[0];if(!i&&u&&(i=t[[n,u].join("/")]),!i)throw new Error(`No private key found: ${n}`);return this.baseCreateSigner({curve:r,privateKey:i,password:e.password})})),function baseGetSingleSigner(e){return r.apply(this,arguments)}),f.baseGetPrivateKeys=(t=(0,o.A)((function*({payload:e,curve:r}){var{credentials:t,account:n,password:i}=e,u={};if(t.hd&&t.imported)throw new s.He("getPrivateKeys ERROR: hd and imported credentials can NOT both set.");if(t.hd){var{relPaths:o}=n;u=yield this.baseGetPrivateKeysHd({curve:r,account:n,hdCredential:t.hd,password:i,relPaths:o})}if(t.imported){var{privateKey:a}=(0,P.VV)({password:i,credential:t.imported}),O=c.A.bytesToHex((0,P.w)(i,a));u[n.path]=O,u[""]=O}if(!Object.keys(u).length)throw new Error("No private keys found");return u})),function baseGetPrivateKeys(e){return t.apply(this,arguments)}),f.baseGetPrivateKeysHd=(n=(0,o.A)((function*({curve:e,password:r,account:t,relPaths:n,hdCredential:i}){var{path:u}=t,o=u.split("/"),a=n||[o.pop()],O=o.join("/");if(0===a.length)throw new s.He("getPrivateKeysHd ERROR: relPaths is empty.");return(0,P.Wu)(e,i,r,O,a).reduce((function(e,r){return _objectSpread(_objectSpread({},e),{},{[r.path]:c.A.bytesToHex(r.extendedKey.key)})}),{})})),function baseGetPrivateKeysHd(e){return n.apply(this,arguments)}),f.baseGetAddressesFromHd=(u=(0,o.A)((function*(e,r){var t=this,{curve:n,generateFrom:u}=r,{template:a,hdCredential:f,password:_,indexes:p}=e,{pathPrefix:d,pathSuffix:h}=(0,O.Ah)(a),l=p.map((function(e){return h.replace("{index}",e.toString())})),E="privateKey"===u,A=[],S=[];E?S=(0,P.Wu)(n,f,_,d,l):A=(0,P.W6)(n,f,_,d,l);var T=E?S:A;if(T.length!==p.length)throw new s.He("Unable to get publick key.");var v,I=yield Promise.all(T.map((v=(0,o.A)((function*(r){var n,u,{path:o,extendedKey:{key:a}}=r;if(E){var s=c.A.bytesToHex((0,P.Yc)(_,a));u=yield t.getAddressFromPrivate({networkInfo:e.networkInfo,privateKeyRaw:s,privateKeyInfo:r})}else n=a.toString("hex"),u=yield t.getAddressFromPublic({networkInfo:e.networkInfo,publicKey:n,publicKeyInfo:r});return i()({publicKey:n,path:o},u)})),function(e){return v.apply(this,arguments)})));return{addresses:I}})),function baseGetAddressesFromHd(e,r){return u.apply(this,arguments)}),(0,a.A)(CoreChainApiBase)}()},711716:(e,r,t)=>{t.r(r),t.d(r,{default:()=>a});var n=t(230414),i=t(929296),u=t(195309),o=t(972715);function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,o.A)(e);if(r){var i=(0,o.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,u.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var a=function(e){(0,i.A)(CoreChainHd,e);var r=_createSuper(CoreChainHd);function CoreChainHd(){return r.apply(this,arguments)}return(0,n.A)(CoreChainHd)}(t(178821).A)},178821:(e,r,t)=>{t.d(r,{A:()=>p});var n=t(586330),i=t(230414),u=t(929296),o=t(195309),a=t(972715),s=t(606777),c=t(940916),P=t(180556),O=t(241066),f=t(507140);function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,a.A)(e);if(r){var i=(0,a.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,o.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var _="secp256k1",p=function(e){(0,u.A)(CoreChainSoftware,e);var r=_createSuper(CoreChainSoftware);function CoreChainSoftware(){return r.apply(this,arguments)}var t,o,a,c,p,d,h=CoreChainSoftware.prototype;return h.getPrivateKeys=(t=(0,n.A)((function*(e){return e.credentials.hd&&(e.account.relPaths=e.account.relPaths||["0/0"]),this.baseGetPrivateKeys({payload:e,curve:_})})),function getPrivateKeys(e){return t.apply(this,arguments)}),h.signTransaction=(o=(0,n.A)((function*(e){var{unsignedTx:r,account:t}=e,n=yield this.baseGetSingleSigner({payload:e,curve:_});if(!t.address)throw new Error("nexa signTransaction ERROR: account.address is required");return yield(0,O._h)(r,n,t.address)})),function signTransaction(e){return o.apply(this,arguments)}),h.signMessage=(a=(0,n.A)((function*(){throw new f.MS})),function signMessage(){return a.apply(this,arguments)}),h.getAddressFromPrivate=(c=(0,n.A)((function*(e){var{privateKeyRaw:r}=e,t=s.A.toBuffer(r),n=this.baseGetCurve(_).publicFromPrivate(t);return this.getAddressFromPublic({publicKey:s.A.bytesToHex(n),networkInfo:e.networkInfo})})),function getAddressFromPrivate(e){return c.apply(this,arguments)}),h.getAddressFromPublic=(p=(0,n.A)((function*(e){var{publicKey:r,networkInfo:t,publicKeyInfo:n}=e,i=r,u=n?.path||"",o=(0,P.vN)({fullPath:u}),a=u?o:"",s=(0,O.TF)({address:i,chainId:t.chainId});return Promise.resolve({address:i,publicKey:r,xpub:"",path:a,addresses:{[t.networkId]:s},relPath:"0/0"})})),function getAddressFromPublic(e){return p.apply(this,arguments)}),h.getAddressesFromHd=(d=(0,n.A)((function*(e){return this.baseGetAddressesFromHd(e,{curve:_})})),function getAddressesFromHd(e){return d.apply(this,arguments)}),(0,i.A)(CoreChainSoftware)}(c.G)},241066:(e,r,t)=>{t.d(r,{kv:()=>buildInputScriptBuffer,hn:()=>buildRawTx,VC:()=>buildSignatureBuffer,cQ:()=>buildTxid,lE:()=>estimateFee,TF:()=>getDisplayAddress,LX:()=>getNexaPrefix,_h:()=>signEncodedTx,aJ:()=>verifyNexaAddress});var n=t(901048),i=t(682823),u=t.n(i),o=t(396599),a=t.n(o),s=t(901048).Buffer,c=function(e){return e.PayToPublicKeyHash="P2PKH",e.PayToScriptHash="SCRIPT",e.PayToScriptTemplate="TEMPLATE",e.GroupedPayToPublicKeyTemplate="GROUP",e}({});function concat(e,r){var t=new Uint8Array(e.length+r.length);return t.set(e),t.set(r,e.length),t}function convertBits(e,r,t,n){for(var i=n?Math.floor(e.length*r/t):Math.ceil(e.length*r/t),u=(1<<t)-1,o=new Uint8Array(i),a=0,s=0,c=0,P=0;P<e.length;P+=1){for(s=s<<r|e[P],c+=r;c>=t;)c-=t,o[a]=s>>c&u,a+=1}return n||c>0&&(o[a]=s<<t-c&u,a+=1),o}var P="qpzry9x8gf2tvdw0s3jn54khce6mua7l";function address_encode(e,r,t){var n=concat(function prefixToUint5Array(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t+=1)r[t]=31&e[t].charCodeAt(0);return r}(e),new Uint8Array(1)),i=function getTypeBits(e){switch(e){case"P2PKH":return 0;case"SCRIPT":return 8;case"TEMPLATE":return 152;case"GROUP":return 88;default:throw new Error(`Invalid type: ${e}.`)}}(r),u=function toUint5Array(e){return convertBits(e,8,5)}(s.from(concat(s.from(new Uint8Array([i])),t))),o=concat(concat(n,u),new Uint8Array(8));return`${e}:${function base32Encode(e){for(var r="",t=0;t<e.length;t+=1){var n=e[t];r+=P[n]}return r}(concat(u,function checksumToUint5Array(e){for(var r=new Uint8Array(8),t=0;t<8;t+=1)r[7-t]=e.and(31).toJSNumber(),e=e.shiftRight(5);return r}(function polymod(e){for(var r=[656907472481,522768456162,0xf33e5fb3c4,748107326120,130178868336],t=a()(1),n=0;n<e.length;n+=1){var i=e[n],u=t.shiftRight(35);t=t.and(34359738367).shiftLeft(5).xor(i);for(var o=0;o<r.length;o+=1)u.shiftRight(o).and(1).equals(1)&&(t=t.xor(r[o]))}return t.xor(1)}(o))))}`}function decode(e){var r=e.toLowerCase().split(":"),t=r[0],n=function base32Decode(e){for(var r=new Uint8Array(e.length),t=0;t<e.length;t+=1){var n=e[t];r[t]=String(P).indexOf(n)}return r}(r[1]),i=function fromUint5Array(e){return convertBits(e,5,8,!0)}(s.from(n.subarray(0,-8))),u=i[0],o=i.subarray(1),a=function getType(e){switch(248&e){case 0:return"P2PKH";case 8:return"SCRIPT";case 152:return"TEMPLATE";case 88:return"GROUP";default:throw new Error(`Invalid address type in version byte: ${e}.`)}}(u);return{prefix:t,type:a,hash:o}}var O=t(901048).Buffer;function getBufferFromBN(e,r,t){try{return e.toBuffer(r,t)}catch(n){return e.toArrayLike(O,r,t)}}var f=function(e){return e[e.OP_FALSE=0]="OP_FALSE",e[e.OP_0=0]="OP_0",e[e.OP_PUSHDATA1=76]="OP_PUSHDATA1",e[e.OP_PUSHDATA2=77]="OP_PUSHDATA2",e[e.OP_PUSHDATA4=78]="OP_PUSHDATA4",e[e.OP_1NEGATE=79]="OP_1NEGATE",e[e.OP_RESERVED=80]="OP_RESERVED",e[e.OP_TRUE=81]="OP_TRUE",e[e.OP_1=81]="OP_1",e[e.OP_2=82]="OP_2",e[e.OP_3=83]="OP_3",e[e.OP_4=84]="OP_4",e[e.OP_5=85]="OP_5",e[e.OP_6=86]="OP_6",e[e.OP_7=87]="OP_7",e[e.OP_8=88]="OP_8",e[e.OP_9=89]="OP_9",e[e.OP_10=90]="OP_10",e[e.OP_11=91]="OP_11",e[e.OP_12=92]="OP_12",e[e.OP_13=93]="OP_13",e[e.OP_14=94]="OP_14",e[e.OP_15=95]="OP_15",e[e.OP_16=96]="OP_16",e[e.OP_NOP=97]="OP_NOP",e[e.OP_VER=98]="OP_VER",e[e.OP_IF=99]="OP_IF",e[e.OP_NOTIF=100]="OP_NOTIF",e[e.OP_VERIF=101]="OP_VERIF",e[e.OP_VERNOTIF=102]="OP_VERNOTIF",e[e.OP_ELSE=103]="OP_ELSE",e[e.OP_ENDIF=104]="OP_ENDIF",e[e.OP_VERIFY=105]="OP_VERIFY",e[e.OP_RETURN=106]="OP_RETURN",e[e.OP_TOALTSTACK=107]="OP_TOALTSTACK",e[e.OP_FROMALTSTACK=108]="OP_FROMALTSTACK",e[e.OP_2DROP=109]="OP_2DROP",e[e.OP_2DUP=110]="OP_2DUP",e[e.OP_3DUP=111]="OP_3DUP",e[e.OP_2OVER=112]="OP_2OVER",e[e.OP_2ROT=113]="OP_2ROT",e[e.OP_2SWAP=114]="OP_2SWAP",e[e.OP_IFDUP=115]="OP_IFDUP",e[e.OP_DEPTH=116]="OP_DEPTH",e[e.OP_DROP=117]="OP_DROP",e[e.OP_DUP=118]="OP_DUP",e[e.OP_NIP=119]="OP_NIP",e[e.OP_OVER=120]="OP_OVER",e[e.OP_PICK=121]="OP_PICK",e[e.OP_ROLL=122]="OP_ROLL",e[e.OP_ROT=123]="OP_ROT",e[e.OP_SWAP=124]="OP_SWAP",e[e.OP_TUCK=125]="OP_TUCK",e[e.OP_CAT=126]="OP_CAT",e[e.OP_SPLIT=127]="OP_SPLIT",e[e.OP_NUM2BIN=128]="OP_NUM2BIN",e[e.OP_BIN2NUM=129]="OP_BIN2NUM",e[e.OP_SIZE=130]="OP_SIZE",e[e.OP_INVERT=131]="OP_INVERT",e[e.OP_AND=132]="OP_AND",e[e.OP_OR=133]="OP_OR",e[e.OP_XOR=134]="OP_XOR",e[e.OP_EQUAL=135]="OP_EQUAL",e[e.OP_EQUALVERIFY=136]="OP_EQUALVERIFY",e[e.OP_RESERVED1=137]="OP_RESERVED1",e[e.OP_RESERVED2=138]="OP_RESERVED2",e[e.OP_1ADD=139]="OP_1ADD",e[e.OP_1SUB=140]="OP_1SUB",e[e.OP_2MUL=141]="OP_2MUL",e[e.OP_2DIV=142]="OP_2DIV",e[e.OP_NEGATE=143]="OP_NEGATE",e[e.OP_ABS=144]="OP_ABS",e[e.OP_NOT=145]="OP_NOT",e[e.OP_0NOTEQUAL=146]="OP_0NOTEQUAL",e[e.OP_ADD=147]="OP_ADD",e[e.OP_SUB=148]="OP_SUB",e[e.OP_MUL=149]="OP_MUL",e[e.OP_DIV=150]="OP_DIV",e[e.OP_MOD=151]="OP_MOD",e[e.OP_LSHIFT=152]="OP_LSHIFT",e[e.OP_RSHIFT=153]="OP_RSHIFT",e[e.OP_BOOLAND=154]="OP_BOOLAND",e[e.OP_BOOLOR=155]="OP_BOOLOR",e[e.OP_NUMEQUAL=156]="OP_NUMEQUAL",e[e.OP_NUMEQUALVERIFY=157]="OP_NUMEQUALVERIFY",e[e.OP_NUMNOTEQUAL=158]="OP_NUMNOTEQUAL",e[e.OP_LESSTHAN=159]="OP_LESSTHAN",e[e.OP_GREATERTHAN=160]="OP_GREATERTHAN",e[e.OP_LESSTHANOREQUAL=161]="OP_LESSTHANOREQUAL",e[e.OP_GREATERTHANOREQUAL=162]="OP_GREATERTHANOREQUAL",e[e.OP_MIN=163]="OP_MIN",e[e.OP_MAX=164]="OP_MAX",e[e.OP_WITHIN=165]="OP_WITHIN",e[e.OP_RIPEMD160=166]="OP_RIPEMD160",e[e.OP_SHA1=167]="OP_SHA1",e[e.OP_SHA256=168]="OP_SHA256",e[e.OP_HASH160=169]="OP_HASH160",e[e.OP_HASH256=170]="OP_HASH256",e[e.OP_CODESEPARATOR=171]="OP_CODESEPARATOR",e[e.OP_CHECKSIG=172]="OP_CHECKSIG",e[e.OP_CHECKSIGVERIFY=173]="OP_CHECKSIGVERIFY",e[e.OP_CHECKMULTISIG=174]="OP_CHECKMULTISIG",e[e.OP_CHECKMULTISIGVERIFY=175]="OP_CHECKMULTISIGVERIFY",e[e.OP_NOP2=177]="OP_NOP2",e[e.OP_CHECKLOCKTIMEVERIFY=177]="OP_CHECKLOCKTIMEVERIFY",e[e.OP_NOP3=178]="OP_NOP3",e[e.OP_CHECKSEQUENCEVERIFY=178]="OP_CHECKSEQUENCEVERIFY",e[e.OP_NOP1=176]="OP_NOP1",e[e.OP_NOP4=179]="OP_NOP4",e[e.OP_NOP5=180]="OP_NOP5",e[e.OP_NOP6=181]="OP_NOP6",e[e.OP_NOP7=182]="OP_NOP7",e[e.OP_NOP8=183]="OP_NOP8",e[e.OP_NOP9=184]="OP_NOP9",e[e.OP_NOP10=185]="OP_NOP10",e[e.OP_CHECKDATASIG=186]="OP_CHECKDATASIG",e[e.OP_CHECKDATASIGVERIFY=187]="OP_CHECKDATASIGVERIFY",e[e.OP_REVERSEBYTES=188]="OP_REVERSEBYTES",e[e.OP_PREFIX_BEGIN=240]="OP_PREFIX_BEGIN",e[e.OP_PREFIX_END=241]="OP_PREFIX_END",e[e.OP_SMALLINTEGER=250]="OP_SMALLINTEGER",e[e.OP_PUBKEYS=251]="OP_PUBKEYS",e[e.OP_PUBKEYHASH=253]="OP_PUBKEYHASH",e[e.OP_PUBKEY=254]="OP_PUBKEY",e[e.OP_INVALIDOPCODE=255]="OP_INVALIDOPCODE",e[e.OP_INPUTINDEX=192]="OP_INPUTINDEX",e[e.OP_ACTIVEBYTECODE=193]="OP_ACTIVEBYTECODE",e[e.OP_TXVERSION=194]="OP_TXVERSION",e[e.OP_TXINPUTCOUNT=195]="OP_TXINPUTCOUNT",e[e.OP_TXOUTPUTCOUNT=196]="OP_TXOUTPUTCOUNT",e[e.OP_TXLOCKTIME=197]="OP_TXLOCKTIME",e[e.OP_UTXOVALUE=198]="OP_UTXOVALUE",e[e.OP_UTXOBYTECODE=199]="OP_UTXOBYTECODE",e[e.OP_OUTPOINTTXHASH=200]="OP_OUTPOINTTXHASH",e[e.OP_OUTPOINTINDEX=201]="OP_OUTPOINTINDEX",e[e.OP_INPUTBYTECODE=202]="OP_INPUTBYTECODE",e[e.OP_INPUTSEQUENCENUMBER=203]="OP_INPUTSEQUENCENUMBER",e[e.OP_OUTPUTVALUE=204]="OP_OUTPUTVALUE",e[e.OP_OUTPUTBYTECODE=205]="OP_OUTPUTBYTECODE",e[e.OP_RESERVED3=206]="OP_RESERVED3",e[e.OP_RESERVED4=207]="OP_RESERVED4",e}({});function script_bufferToScripChunk(e){var r,t=e.length;if(t>=0&&t<f.OP_PUSHDATA1)r=t;else if(t<256)r=f.OP_PUSHDATA1;else if(t<65536)r=f.OP_PUSHDATA2;else{if(!(t<2**32))throw new Error("You can't push that much data");r=f.OP_PUSHDATA4}return{buf:e,len:t,opcodenum:r}}function writeUInt8(e){var r=n.Buffer.alloc(1);return r.writeUInt8(e,0),r}function writeUInt16LE(e){var r=n.Buffer.alloc(2);return r.writeUInt16LE(e,0),r}function writeUInt32LE(e){var r=n.Buffer.alloc(4);return r.writeUInt32LE(e,0),r}function writeUInt64LEBN(e){return getBufferFromBN(e,"le",8)}function varintBufNum(e){var r;return e<253?(r=n.Buffer.alloc(1)).writeUInt8(e,0):e<65536?((r=n.Buffer.alloc(3)).writeUInt8(253,0),r.writeUInt16LE(e,1)):e<4294967296?((r=n.Buffer.alloc(5)).writeUInt8(254,0),r.writeUInt32LE(e,1)):((r=n.Buffer.alloc(9)).writeUInt8(255,0),r.writeInt32LE(-1&e,1),r.writeUInt32LE(Math.floor(e/4294967296),5)),r}function script_scriptChunksToBuffer(e){for(var r=[],t=0,i=0;i<e.length;i+=1){var u=e[i],{opcodenum:o,buf:a}=u,s=writeUInt8(o);if(r.push(s),t+=s.length,a){var c=void 0;o===f.OP_PUSHDATA1?c=writeUInt8(o):o===f.OP_PUSHDATA2?c=writeUInt16LE(u.len||0):o===f.OP_PUSHDATA4&&(c=writeUInt32LE(u.len||0)),c&&(r.push(c),t+=c.length),r.push(a),t+=a.length}}return n.Buffer.concat(r,t)}function readVarintNum(e){var r=0,t=e.readUInt8(0);switch(r+=1,t){case 253:t=e.readUInt16LE(0),r+=2;break;case 254:t=e.readUInt32LE(0),r+=4;break;case 255:var{bn:n,position:i}=function readUInt64LEBN(e,r){var t,n=e.readUInt32LE(r),i=4294967296*e.readUInt32LE(r+4)+n;if(i<=9007199254740991)t=new(u())(i);else{var o=Array.prototype.slice.call(e,r,r+8);t=new(u())(o,10,"le")}return{bn:t,position:r+8}}(e,r),o=n.toNumber();if(r=i,!(o<=2**53))throw new Error("number too large to retain precision - use readVarintBN");t=o}return{position:r,length:t}}function getScriptBufferFromScriptTemplateOut(e){var{hash:r}=decode(e);return function readVarLengthBuffer(e){var{position:r,length:t}=readVarintNum(e);return e.slice(r,t+r)}(n.Buffer.from(r))}var _=t(913360),p=t.n(_),d=t(554902),h=t(901048).Buffer,l=new(0,p().ec)("secp256k1");function reverseBuffer(e){for(var r="string"==typeof e?h.from(e,"hex"):e,{length:t}=r,n=h.alloc(t),i=0;i<t;i+=1)n[i]=r[t-i-1];return n}function getBN(e,r=!1){var t=(r?reverseBuffer(e):e).toString("hex");return new(u())(t,16)}function hasSquare(e){return!e.isInfinity()&&function isSquare(e){var r=new(u())("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","hex");return new(u())(e).toRed(u().red(r)).redPow(r.sub(new(u())(1)).div(new(u())(2))).fromRed().eq(new(u())(1))}(new(u())(e.getY().toArray()))}function getrBuffer(e){return getBufferFromBN(e).length<32?getBufferFromBN(e,"be",32):getBufferFromBN(e)}function pointToCompressed(e){var r,t=getBufferFromBN(e.getX(),"be",32),n=getBufferFromBN(e.getY(),"be",32);return r=n[n.length-1]%2?h.from([3]):h.from([2]),h.concat([r,t])}function findSignature(e,r){var t=l.curve.g,n=new(u())(l.curve.n.toArray()),i=function nonceFunctionRFC6979(e,r){var t=h.from("0101010101010101010101010101010101010101010101010101010101010101","hex"),n=h.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),i=h.concat([e,r,h.from("","ascii"),h.from("Schnorr+SHA256  ","ascii")]);n=(0,d.zP)(n,h.concat([t,h.from("00","hex"),i])),t=(0,d.zP)(n,t),n=(0,d.zP)(n,h.concat([t,h.from("01","hex"),i])),t=(0,d.zP)(n,t);for(var o=new(u())(0),a=new(u())(l.curve.n.toArray());!(o=getBN(t=(0,d.zP)(n,t))).gt(new(u())(0))||!o.lt(a);)n=(0,d.zP)(n,h.concat([t,h.from("00","hex")])),t=(0,d.zP)(n,t);return o}(getBufferFromBN(e,"be",32),getBufferFromBN(r,"be",32)),o=t.mul(e),a=t.mul(i);hasSquare(a)||(i=n.sub(i));var s=a.getX();return{r:s,s:getBN((0,d.sc)(h.concat([getrBuffer(s),pointToCompressed(o),getBufferFromBN(r,"be",32)]))).mul(e).add(i).mod(n)}}var E=t(324586),A=t(586330),S=t(507140),T=t(825145),v=function(e){return e[e.SIGHASH_NEXA_ALL=0]="SIGHASH_NEXA_ALL",e[e.SIGHASH_ALL=1]="SIGHASH_ALL",e[e.SIGHASH_NONE=2]="SIGHASH_NONE",e[e.SIGHASH_SINGLE=3]="SIGHASH_SINGLE",e[e.SIGHASH_FORKID=64]="SIGHASH_FORKID",e[e.SIGHASH_ANYONECANPAY=128]="SIGHASH_ANYONECANPAY",e}({}),I=t(901048).Buffer;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,E.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function verifyNexaAddress(e){try{return decode(e),{isValid:!0,normalizedAddress:e}}catch(e){return{isValid:!1}}}var y={mainnet:{name:"livenet",alias:"mainnet",prefix:"nexa",pubkeyhash:25,privatekey:35,scripthash:68,xpubkey:1114203936,xprivkey:1114401651,networkMagic:1915163169},testnet:{name:"nexatest",prefix:"nexatest",pubkeyhash:111,privatekey:239,scripthash:196,xpubkey:70617039,xprivkey:70615956,networkMagic:4108710900}};function getNexaNetworkInfo(e){return"testnet"===e?y.testnet:y.mainnet}function getNexaPrefix(e){return getNexaNetworkInfo(e).prefix}function convertScriptToPushBuffer(e){return script_scriptChunksToBuffer([script_bufferToScripChunk(e)])}function getDisplayAddress({address:e,chainId:r}){return function verifyNexaAddressPrefix(e){return e.startsWith("nexa:")||e.startsWith("nexatest:")}(e)?e:function publickeyToAddress(e,r,t=c.PayToScriptTemplate){var n,i=getNexaNetworkInfo(r);if(t===c.PayToPublicKeyHash)n=(0,d.A0)(e);else{if(t!==c.PayToScriptTemplate)throw new S.q4;var u=script_scriptChunksToBuffer([script_bufferToScripChunk(e)]),o=(0,d.A0)(u),a=[{opcodenum:f.OP_FALSE},{opcodenum:f.OP_1},script_bufferToScripChunk(o)];n=script_scriptChunksToBuffer([script_bufferToScripChunk(script_scriptChunksToBuffer(a))])}return address_encode(i.prefix,t,n)}(I.from(e,"hex"),r)}function sha256sha256(e){return(0,d.sc)((0,d.sc)(e))}var g=4294967295,N=3e3,U=33;function estimateFee(e,r=N/1e3){var t=function estimateSize(e){var r=5;return r+=e.inputs.length<253?1:3,e.inputs.forEach((function(){r+=146})),e.outputs.forEach((function(e){var t=getScriptBufferFromScriptTemplateOut(e.address);r+=convertScriptToPushBuffer(t).length+1+8+1})),r}(e);return Math.ceil(t*r+U*r)}function buildInputScriptBuffer(e,r){return script_scriptChunksToBuffer([script_bufferToScripChunk(script_scriptChunksToBuffer([script_bufferToScripChunk(e)])),script_bufferToScripChunk(r)])}function buildInputIdemWithSignature({sigtype:e,prevTxId:r,scriptBuffer:t,sequenceNumber:n,amount:i}){return I.concat([writeUInt8(e),reverseBuffer(r),varintBufNum(t.length),t,writeUInt32LE(n),writeUInt64LEBN(i)])}function buildInputIdem({sigtype:e,prevTxId:r,sequenceNumber:t,amount:n}){return I.concat([writeUInt8(e),reverseBuffer(r),writeUInt32LE(t),writeUInt64LEBN(n)])}function buildOutputIdem({outType:e,satoshi:r,scriptBuffer:t}){return I.concat([writeUInt8(e),writeUInt64LEBN(r),varintBufNum(t.length),t])}function buildRawTx(e,r,t=0,n=!1){var i=I.concat(e.map(n?buildInputIdemWithSignature:buildInputIdem)),u=I.concat(r.map(buildOutputIdem));return I.concat([writeUInt8(0),varintBufNum(e.length),i,varintBufNum(r.length),u,writeUInt32LE(t)])}function buildTxid(e,r,t=0){var i,u,o=sha256sha256(buildRawTx(e,r,t)),a=sha256sha256(I.concat([(i=e.length,u=n.Buffer.alloc(4),u.writeInt32LE(i,0),u),I.concat(e.map((function({scriptBuffer:e}){return I.concat([e,writeUInt8(f.OP_INVALIDOPCODE)])})))]));return reverseBuffer(sha256sha256(I.concat([o,a]))).toString("hex")}function buildSignatureBuffer(e,r){var{inputs:t}=e,n=sha256sha256(I.concat(t.map((function(e){return I.concat([writeUInt8(0),reverseBuffer(I.from(e.txId,"hex"))])})))),i=sha256sha256(I.concat(t.map((function(e){return writeUInt32LE(e.sequenceNumber||g)})))),o=sha256sha256(I.concat(t.map((function(e){return writeUInt64LEBN(new(u())(e.satoshis))})))),{outputSignatures:a,inputSignatures:s}=function buildSignatures(e,r){var{inputs:t,outputs:n,gas:i}=e,o=n.slice(),a=t.reduce((function(e,r){return e.add(new(u())(r.satoshis))}),new(u())(0)),s=o.reduce((function(e,r){return e.add(new(u())(r.satoshis))}),new(u())(0)),c=new(u())(i||estimateFee(e)),P=a.sub(c);if(P.lt(new(u())(0)))throw console.error(a.toString(),c.toString()),new Error(`Available balance cannot be less than 0, inputAmount: ${a.toString()}, dust: ${c.toString()}`);return P.gt(s)?o.push({address:r,satoshis:P.sub(s).toString(),outType:1}):o[0].satoshis=P.gt(s)?o[0].satoshis:P.toString(),{outputSignatures:o.map((function(e){return{address:e.address,satoshi:new(u())(e.satoshis),outType:1,scriptBuffer:getScriptBufferFromScriptTemplateOut(e.address)}})),inputSignatures:t.map((function(e,r){return{prevTxId:e.txId,outputIndex:e.outputIndex,inputIndex:r,sequenceNumber:e.sequenceNumber||g,amount:new(u())(e.satoshis),sigtype:v.SIGHASH_NEXA_ALL}}))}}(e,r),c=sha256sha256(I.concat(a.map((function(e){return I.concat([writeUInt8(e.outType),writeUInt64LEBN(new(u())(e.satoshi)),varintBufNum(e.scriptBuffer.length),e.scriptBuffer])})))),P=script_scriptChunksToBuffer([{opcodenum:f.OP_FROMALTSTACK},{opcodenum:f.OP_CHECKSIGVERIFY}]);return{signatureBuffer:I.concat([writeUInt8(0),n,o,i,varintBufNum(P.length),P,c,writeUInt32LE(0),writeUInt8(0)]),inputSignatures:s,outputSignatures:a}}function signEncodedTx(e,r,t){return _signEncodedTx.apply(this,arguments)}function _signEncodedTx(){return(_signEncodedTx=(0,A.A)((function*(e,r,t){(0,T.wT)(t);var n=e.encodedTx,i=yield r.getPrvkey(),u=yield r.getPubkey(!0),{outputSignatures:o,inputSignatures:a,signatureBuffer:s}=buildSignatureBuffer(n,t),c=sha256sha256(s),P=function sign(e,r){var t=getBN(e),n=getBN(r),{r:i,s:u}=findSignature(t,n);return h.concat([getBufferFromBN(i,"be",32),getBufferFromBN(u,"be",32)])}(i,c),O=a.map((function(e){return _objectSpread(_objectSpread({},e),{},{publicKey:u,signature:P,scriptBuffer:buildInputScriptBuffer(u,P)})}));return{txid:buildTxid(O,o),rawTx:buildRawTx(O,o,0,!0).toString("hex"),signature:P.toString("hex"),digest:c.toString("hex"),encodedTx:n}}))).apply(this,arguments)}}}]);