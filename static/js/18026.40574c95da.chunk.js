(self.webpackChunkweb=self.webpackChunkweb||[]).push([[18026],{632617:(e,t,n)=>{"use strict";n.d(t,{b:()=>PhaseInputArea});var r=n(516238),o=n.n(r),u=n(586330),s=n(573758),a=n.n(s),i=n(324586),c=n(839850),l=n(514041),p=n(416526),f=n(230690),d=n(490343),b=n(310955),h=(n(663522),n(630938)),g=n.n(h),m=n(868557),v=n(701732);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useSuggestion=function(e,t=12){var n,{fetchSuggestions:r,suggestions:o,updateSuggestions:s,suggestionsRef:a}=function(){var[e,t]=(0,l.useState)([]),n=(0,l.useRef)(new Map),r=(0,l.useRef)([]),o=(0,l.useCallback)((function(e){r.current=e,t(e)}),[]);return{fetchSuggestions:(0,l.useCallback)((function(e){if(!e)return[];var t=n.current.get(e);if(t)o(t);else{var u=m.filter((function(t){return t.startsWith(e)}));n.current.set(e,g()(u)),o(u)}return r.current}),[o]),suggestionsRef:r,suggestions:e,updateSuggestions:o}}(),[i,c]=(0,l.useState)({}),[p,f]=(0,l.useState)(-1),b=(0,l.useRef)(!1),h=(0,l.useRef)(!1),x=(0,l.useCallback)((function(e,t,n=!1){setTimeout((function(){if(t){if(n&&(!b.current||a.current&&0===a.current?.length))return r=t,void(m.includes(r)?c((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})})):c((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!0})})));var r;p===e&&a.current&&a.current?.length>0?c((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})})):c((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})}))}else c((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})}))}),0)}),[p,a]),j=(0,l.useCallback)((function(){b.current=!1,s([])}),[s]),S=(0,l.useCallback)((0,u.A)((function*(){yield v.A.runAfterInteractions();var t=`phrase${p+2}`;yield new Promise((function(n){setTimeout((function(){e.setFocus(t),n()}),300)}))})),[e,t,p]),y=(0,l.useCallback)((function(t){var n=`phrase${p+1}`;e.setValue(n,t)}),[e,p]),P=(0,l.useCallback)((function(e){if(h.current)return e;e||j();var t=e.toLowerCase().trim(),n=r(t);return b.current=n.length>0,x(p,t),t}),[x,r,j,p]),I=(0,l.useCallback)((function(t){var n=`phrase${t+1}`;return e.getValues()[n]}),[e]),C=(0,l.useCallback)((n=(0,u.A)((function*(e){h.current=!0,y(e),j(),e&&e.length>0?(yield S(),setTimeout((function(){h.current=!1}),0)):h.current=!1})),function(e){return n.apply(this,arguments)}),[S,j,y]);(0,d.useKeyboardEvent)({keyboardWillHide:function(){setTimeout((function(){s([])}))}});var w,k=(0,l.useCallback)((function(e){f(e)}),[]),$=(0,l.useCallback)((w=(0,u.A)((function*(e){b.current&&e===p||(e===p&&f(-1),b.current=!1,x(p,I(e),!0))})),function(e){return w.apply(this,arguments)}),[x,I,p]),{clearText:O}=(0,d.useClipboard)(),R=(0,l.useCallback)((function(n){var r=n.split(" ");return r.length===t&&(setTimeout((function(){O(),d.Toast.success({title:"Pasted and clipboard cleared"}),e.reset(r.reduce((function(e,t,n){return e[`phrase${n+1}`]=t,e}),{})),j()}),10),!0)}),[O,e,t,j]),A=(0,l.useCallback)((function(){j(),x(p,I(p),!0)}),[x,I,j,p]);return(0,l.useMemo)((function(){return{isShowErrors:i,suggestions:o,onInputFocus:k,onInputBlur:$,onPasteMnemonic:R,suggestionsRef:a,updateInputValue:C,openStatusRef:b,onInputChange:P,selectInputIndex:p,focusNextInput:S,closePopover:A}}),[i,o,k,$,R,a,C,P,p,S,A])},x=n(831085),j=["word","onPress","tabIndex","buttonRef","number"];function PhaseInputArea_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PhaseInputArea_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PhaseInputArea_ownKeys(Object(n),!0).forEach((function(t){(0,i.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PhaseInputArea_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=f.A,y=[{label:"12 words",value:"12"},{label:"15 words",value:"15"},{label:"18 words",value:"18"},{label:"21 words",value:"21"},{label:"24 words",value:"24"}];function WordItem(e){var{word:t,onPress:n,tabIndex:r=-1,buttonRef:o,number:u}=e,s=(0,c.A)(e,j),a=(0,l.useCallback)((function(){n(t)}),[n,t]);return(0,x.jsxs)(d.Stack,{position:"relative",children:[(0,x.jsx)(d.Button,PhaseInputArea_objectSpread(PhaseInputArea_objectSpread({size:"small",ref:o,onPress:a,focusable:!0,tabIndex:r},s),{},{children:t})),(0,x.jsx)(d.Stack,{bg:"$bg",position:"absolute",right:"$px",top:"$0",height:"$4",width:"$4",justifyContent:"center",alignItems:"center",borderRadius:"$full",children:(0,x.jsx)(d.SizableText,{size:"$bodySmMedium",color:"$textSubdued",children:u})})]})}function SuggestionList({suggestions:e,onPressItem:t,firstButtonRef:n,isFocusable:r=!1}){var o=e.slice(0,9).map((function(e,o){return(0,x.jsx)(WordItem,{number:o+1,buttonRef:0===o?n:void 0,tabIndex:r?0:-1,word:e,onPress:t,m:"$1.5",testID:`suggest-${e}`},e)}));return(0,x.jsx)(d.XStack,{flexWrap:"wrap",p:"$1.5",children:o})}function PageFooter({suggestions:e,updateInputValue:t,onConfirm:n}){var r=(0,d.useIsKeyboardShown)();return(0,x.jsxs)(d.Page.Footer,{children:[(0,x.jsx)(d.Page.FooterActions,{onConfirm:n}),r?(0,x.jsx)(SuggestionList,{suggestions:e,onPressItem:t}):null]})}var{height:P}=p.A.get("window");var I=(0,l.forwardRef)((function BasicPhaseInput({index:e,onChange:t,value:n,isShowError:r=!1,onInputChange:o,onInputFocus:u,onInputBlur:s,onPasteMnemonic:a,suggestionsRef:i,updateInputValue:c,selectInputIndex:p,openStatusRef:f,closePopover:b,onReturnKeyPressed:h,getReturnKeyLabel:g,testID:m=""},v){var j,y=(0,l.useRef)(null),P=(0,d.useMedia)(),{getContentOffset:I,pageRef:C}=(0,d.usePage)(),w=(0,l.useRef)(null),[k,$]=(0,l.useState)(!1);(0,l.useImperativeHandle)(v,(function(){return{focus:function(){y.current?.focus()}}}));var O=(0,l.useCallback)((function(){return g(e)}),[g,e]),R=(0,l.useCallback)((function(){u(e)}),[I,e,u,C]),A=(0,l.useCallback)((function(){s(e)}),[e,s]),T=(0,l.useCallback)((function(e){if(a(e))return o(""),void t?.("");var n=e.replaceAll(" ",""),r=o(n);t?.(r)}),[t,o,a]),K=(0,l.useCallback)((function(e){e||(b(),$(!1))}),[b]),D=(0,l.useCallback)((function(e){if(i.current&&e.keyCode>48&&e.keyCode<58){var t=e.keyCode-48;c(i.current[t-1]),e.preventDefault(),e.stopPropagation()}}),[i,c]),F=(0,l.useCallback)((function(e){9===e.keyCode?f.current&&(w.current?.focus(),$(!0),e.preventDefault(),e.stopPropagation()):D(e)}),[D,f]),_=((0,l.useCallback)((function(){h(e)}),[e,h]),p!==e&&n?.length&&!r?"••••":n),B=null!=(j=i.current)?j:[],M=O(),z={value:_,ref:y,keyboardType:"ascii-capable",autoCapitalize:"none",autoCorrect:!1,spellCheck:!1,autoComplete:"off",size:P.md?"large":"medium",leftAddOnProps:{label:`${e+1}`,minWidth:"$10",justifyContent:"center"},error:r,onChangeText:T,onFocus:R,onBlur:A,returnKeyLabel:M.toUpperCase(),returnKeyType:M,autoFocus:0===e};return(0,x.jsx)(d.Popover,{title:"Select Word",placement:"bottom-start",usingSheet:!1,onOpenChange:K,open:!!f.current&&(p===e&&B.length>0),floatingPanelProps:{$md:{px:"$4",width:"100vw",outlineWidth:0,bg:"$transparent",borderWidth:0}},renderContent:(0,x.jsx)(d.Stack,{$md:{bg:"$bg",borderRadius:"$3"},children:(0,x.jsx)(S,{onKeyDown:D,children:(0,x.jsx)(SuggestionList,{firstButtonRef:w,suggestions:B,onPressItem:c,isFocusable:k})})}),renderTrigger:(0,x.jsx)(d.Stack,{children:(0,x.jsx)(d.Input,PhaseInputArea_objectSpread(PhaseInputArea_objectSpread({},z),{},{onKeyPress:F,"data-1p-ignore":!0,testID:m}))})})}));function PhaseInputArea({onConfirm:e,FooterComponent:t,showPhraseLengthSelector:n=!0,showClearAllButton:r=!0,defaultPhrases:s=[]}){var[i,c]=(0,l.useState)(y[0].value),{serviceAccount:p,servicePassword:f}=b.A,h=(0,l.useMemo)((function(){var e={};return a()(0,Number(i))?.forEach((function(t,n){e[`phrase${n+1}`]=s[n]||""})),e}),[s,i]),g=(0,d.useForm)({defaultValues:h}),m=(0,l.useCallback)((0,u.A)((function*(){var t=Object.values(g.getValues()).join(" "),n=yield f.encodeSensitiveText({text:t});yield p.validateMnemonic(n),e(n)})),[g,e,p,f]),{suggestions:v,updateInputValue:j,onInputFocus:S,onInputBlur:P,onInputChange:C,suggestionsRef:w,openStatusRef:k,selectInputIndex:$,closePopover:O,focusNextInput:R,onPasteMnemonic:A,isShowErrors:T}=useSuggestion(g,Number(i)),K=(0,l.useCallback)((function(e){e===Number(i)-1?m():R()}),[R,m,i]);(0,d.useKeyboardEvent)({keyboardWillHide:O});var D=(0,l.useCallback)((function(e){return e===Number(i)-1||o()(Object.values(g.getValues())).length===Number(i)?"done":"next"}),[g,i]),F=(0,l.useCallback)((function(){Object.entries(h).forEach((function([e,t]){g.setValue(e,t)}))}),[h,g]),_=(0,l.useCallback)((function(e){c(e),F()}),[F]);return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(d.Page.Body,{children:[n||r?(0,x.jsxs)(d.XStack,{px:"$5",pb:"$2",pt:"$2",justifyContent:"space-between",children:[n?(0,x.jsx)(d.Select,{title:"Select a length",placement:"bottom-start",items:y,value:i,onChange:_,renderTrigger:function({value:e}){return(0,x.jsxs)(d.Button,{iconAfter:"ChevronDownSmallOutline",size:"small",variant:"tertiary",testID:"phrase-length",children:[e," words"]})}}):null,r?(0,x.jsx)(d.Button,{icon:"BroomOutline",size:"small",variant:"tertiary",onPress:F,testID:"clear-all",children:"Clear"}):null]}):null,(0,x.jsx)(d.SecureView,{children:(0,x.jsx)(d.Form,{form:g,children:(0,x.jsx)(d.XStack,{px:"$4",flexWrap:"wrap",children:Array.from({length:Number(i)}).map((function(e,t){return(0,x.jsx)(d.Stack,{$md:{flexBasis:"50%"},flexBasis:"33.33%",p:"$1",children:(0,x.jsx)(d.Form.Field,{name:`phrase${t+1}`,children:(0,x.jsx)(I,{index:t,isShowError:T[t],onInputBlur:P,onInputChange:C,onInputFocus:S,onPasteMnemonic:A,suggestionsRef:w,updateInputValue:j,openStatusRef:k,selectInputIndex:$,closePopover:O,onReturnKeyPressed:K,getReturnKeyLabel:D,testID:`phrase-input-index${t}`})})},t)}))})})}),(0,x.jsxs)(d.HeightTransition,{children:[null,null]}),t]}),(0,x.jsx)(PageFooter,{suggestions:v,updateInputValue:j,onConfirm:m})]})}},518026:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ImportKeyTag:()=>ImportKeyTag,default:()=>p});var r=n(514041),o=n(490343),u=n(498356),s=n(726130),a=n(730223),i=n(117746),c=n(632617),l=n(831085),KeyTagFooterComponent=function(){var e=(0,r.useCallback)((function(){(0,i.Dr)(s.LO)}),[]);return(0,l.jsxs)(o.YStack,{px:"$5",mt:"$10",children:[(0,l.jsx)(o.SizableText,{size:"$headingSm",color:"$textSubdued",children:"How to import from OneKey KeyTag?"}),(0,l.jsx)(o.SizableText,{size:"$bodyMd",color:"$textSubdued",children:"Sum the numbers in each row. This sum represents the word's position in the word list."}),(0,l.jsxs)(o.SizableText,{size:"$bodyMd",color:"$textSubdued",children:["Then, visit the",(0,l.jsxs)(o.SizableText,{textDecorationLine:"underline",size:"$bodyMd",onPress:e,color:"$textSubdued",px:"$1",children:[" ","BIP39-DotMap"," "]}),"website to find the corresponding word for this position."]}),(0,l.jsx)(o.Stack,{borderRadius:12,mt:"$5",overflow:"hidden",children:(0,l.jsx)(o.Stack,{width:"100%",$sm:{height:224},height:300,children:(0,l.jsx)(o.Image,{width:"100%",height:"100%",source:n(259542)})})})]})};function ImportKeyTag(){var e=(0,u.A)(),t=(0,r.useCallback)((function(t){e.push(a.xl.FinalizeWalletSetup,{mnemonic:t})}),[e]),n=(0,r.useMemo)((function(){return(0,l.jsx)(c.b,{defaultPhrases:[],onConfirm:t,FooterComponent:(0,l.jsx)(KeyTagFooterComponent,{})})}),[t]);return(0,l.jsxs)(o.Page,{scrollEnabled:!0,children:[(0,l.jsx)(o.Page.Header,{title:"Import Recovery Phrase"}),n]})}const p=ImportKeyTag},259668:(e,t,n)=>{var r=n(284354),o=n(63151);e.exports=function arrayShuffle(e){return o(r(e))}},796902:e=>{var t=Math.ceil,n=Math.max;e.exports=function baseRange(e,r,o,u){for(var s=-1,a=n(t((r-e)/(o||1)),0),i=Array(a);a--;)i[u?a:++s]=e,e+=o;return i}},927154:(e,t,n)=>{var r=n(63151),o=n(39817);e.exports=function baseShuffle(e){return r(o(e))}},803905:(e,t,n)=>{var r=n(965111);e.exports=function baseValues(e,t){return r(t,(function(t){return e[t]}))}},840165:(e,t,n)=>{var r=n(796902),o=n(674535),u=n(743301);e.exports=function createRange(e){return function(t,n,s){return s&&"number"!=typeof s&&o(t,n,s)&&(n=s=void 0),t=u(t),void 0===n?(n=t,t=0):n=u(n),s=void 0===s?t<n?1:-1:u(s),r(t,n,s,e)}}},63151:(e,t,n)=>{var r=n(306484);e.exports=function shuffleSelf(e,t){var n=-1,o=e.length,u=o-1;for(t=void 0===t?o:t;++n<t;){var s=r(n,u),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}},516238:e=>{e.exports=function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var u=e[t];u&&(o[r++]=u)}return o}},573758:(e,t,n)=>{var r=n(840165)();e.exports=r},630938:(e,t,n)=>{var r=n(259668),o=n(927154),u=n(153142);e.exports=function shuffle(e){return(u(e)?r:o)(e)}},39817:(e,t,n)=>{var r=n(803905),o=n(781211);e.exports=function values(e){return null==e?[]:r(e,o(e))}},259542:(e,t,n)=>{"use strict";e.exports=n.p+"static/media/bip39-dotmap.755032b7d69700d2c846.png"}}]);