(self.webpackChunkweb=self.webpackChunkweb||[]).push([[88539],{632617:(e,t,n)=>{"use strict";n.d(t,{b:()=>PhaseInputArea});var r=n(516238),o=n.n(r),s=n(586330),u=n(573758),a=n.n(u),c=n(324586),i=n(839850),l=n(514041),p=n(416526),f=n(230690),d=n(490343),b=n(310955),g=(n(663522),n(630938)),h=n.n(g),v=n(868557),j=n(701732);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,c.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useSuggestion=function(e,t=12){var n,{fetchSuggestions:r,suggestions:o,updateSuggestions:u,suggestionsRef:a}=function(){var[e,t]=(0,l.useState)([]),n=(0,l.useRef)(new Map),r=(0,l.useRef)([]),o=(0,l.useCallback)((function(e){r.current=e,t(e)}),[]);return{fetchSuggestions:(0,l.useCallback)((function(e){if(!e)return[];var t=n.current.get(e);if(t)o(t);else{var s=v.filter((function(t){return t.startsWith(e)}));n.current.set(e,h()(s)),o(s)}return r.current}),[o]),suggestionsRef:r,suggestions:e,updateSuggestions:o}}(),[c,i]=(0,l.useState)({}),[p,f]=(0,l.useState)(-1),b=(0,l.useRef)(!1),g=(0,l.useRef)(!1),y=(0,l.useCallback)((function(e,t,n=!1){setTimeout((function(){if(t){if(n&&(!b.current||a.current&&0===a.current?.length))return r=t,void(v.includes(r)?i((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})})):i((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!0})})));var r;p===e&&a.current&&a.current?.length>0?i((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})})):i((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})}))}else i((function(t){return _objectSpread(_objectSpread({},t),{},{[e]:!1})}))}),0)}),[p,a]),m=(0,l.useCallback)((function(){b.current=!1,u([])}),[u]),x=(0,l.useCallback)((0,s.A)((function*(){yield j.A.runAfterInteractions();var t=`phrase${p+2}`;yield new Promise((function(n){setTimeout((function(){e.setFocus(t),n()}),300)}))})),[e,t,p]),S=(0,l.useCallback)((function(t){var n=`phrase${p+1}`;e.setValue(n,t)}),[e,p]),P=(0,l.useCallback)((function(e){if(g.current)return e;e||m();var t=e.toLowerCase().trim(),n=r(t);return b.current=n.length>0,y(p,t),t}),[y,r,m,p]),w=(0,l.useCallback)((function(t){var n=`phrase${t+1}`;return e.getValues()[n]}),[e]),I=(0,l.useCallback)((n=(0,s.A)((function*(e){g.current=!0,S(e),m(),e&&e.length>0?(yield x(),setTimeout((function(){g.current=!1}),0)):g.current=!1})),function(e){return n.apply(this,arguments)}),[x,m,S]);(0,d.useKeyboardEvent)({keyboardWillHide:function(){setTimeout((function(){u([])}))}});var C,O=(0,l.useCallback)((function(e){f(e)}),[]),k=(0,l.useCallback)((C=(0,s.A)((function*(e){b.current&&e===p||(e===p&&f(-1),b.current=!1,y(p,w(e),!0))})),function(e){return C.apply(this,arguments)}),[y,w,p]),{clearText:$}=(0,d.useClipboard)(),R=(0,l.useCallback)((function(n){var r=n.split(" ");return r.length===t&&(setTimeout((function(){$(),d.Toast.success({title:"Pasted and clipboard cleared"}),e.reset(r.reduce((function(e,t,n){return e[`phrase${n+1}`]=t,e}),{})),m()}),10),!0)}),[$,e,t,m]),A=(0,l.useCallback)((function(){m(),y(p,w(p),!0)}),[y,w,m,p]);return(0,l.useMemo)((function(){return{isShowErrors:c,suggestions:o,onInputFocus:O,onInputBlur:k,onPasteMnemonic:R,suggestionsRef:a,updateInputValue:I,openStatusRef:b,onInputChange:P,selectInputIndex:p,focusNextInput:x,closePopover:A}}),[c,o,O,k,R,a,I,P,p,x,A])},y=n(831085),m=["word","onPress","tabIndex","buttonRef","number"];function PhaseInputArea_ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function PhaseInputArea_objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?PhaseInputArea_ownKeys(Object(n),!0).forEach((function(t){(0,c.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):PhaseInputArea_ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=f.A,S=[{label:"12 words",value:"12"},{label:"15 words",value:"15"},{label:"18 words",value:"18"},{label:"21 words",value:"21"},{label:"24 words",value:"24"}];function WordItem(e){var{word:t,onPress:n,tabIndex:r=-1,buttonRef:o,number:s}=e,u=(0,i.A)(e,m),a=(0,l.useCallback)((function(){n(t)}),[n,t]);return(0,y.jsxs)(d.Stack,{position:"relative",children:[(0,y.jsx)(d.Button,PhaseInputArea_objectSpread(PhaseInputArea_objectSpread({size:"small",ref:o,onPress:a,focusable:!0,tabIndex:r},u),{},{children:t})),(0,y.jsx)(d.Stack,{bg:"$bg",position:"absolute",right:"$px",top:"$0",height:"$4",width:"$4",justifyContent:"center",alignItems:"center",borderRadius:"$full",children:(0,y.jsx)(d.SizableText,{size:"$bodySmMedium",color:"$textSubdued",children:s})})]})}function SuggestionList({suggestions:e,onPressItem:t,firstButtonRef:n,isFocusable:r=!1}){var o=e.slice(0,9).map((function(e,o){return(0,y.jsx)(WordItem,{number:o+1,buttonRef:0===o?n:void 0,tabIndex:r?0:-1,word:e,onPress:t,m:"$1.5",testID:`suggest-${e}`},e)}));return(0,y.jsx)(d.XStack,{flexWrap:"wrap",p:"$1.5",children:o})}function PageFooter({suggestions:e,updateInputValue:t,onConfirm:n}){var r=(0,d.useIsKeyboardShown)();return(0,y.jsxs)(d.Page.Footer,{children:[(0,y.jsx)(d.Page.FooterActions,{onConfirm:n}),r?(0,y.jsx)(SuggestionList,{suggestions:e,onPressItem:t}):null]})}var{height:P}=p.A.get("window");var w=(0,l.forwardRef)((function BasicPhaseInput({index:e,onChange:t,value:n,isShowError:r=!1,onInputChange:o,onInputFocus:s,onInputBlur:u,onPasteMnemonic:a,suggestionsRef:c,updateInputValue:i,selectInputIndex:p,openStatusRef:f,closePopover:b,onReturnKeyPressed:g,getReturnKeyLabel:h,testID:v=""},j){var m,S=(0,l.useRef)(null),P=(0,d.useMedia)(),{getContentOffset:w,pageRef:I}=(0,d.usePage)(),C=(0,l.useRef)(null),[O,k]=(0,l.useState)(!1);(0,l.useImperativeHandle)(j,(function(){return{focus:function(){S.current?.focus()}}}));var $=(0,l.useCallback)((function(){return h(e)}),[h,e]),R=(0,l.useCallback)((function(){s(e)}),[w,e,s,I]),A=(0,l.useCallback)((function(){u(e)}),[e,u]),_=(0,l.useCallback)((function(e){if(a(e))return o(""),void t?.("");var n=e.replaceAll(" ",""),r=o(n);t?.(r)}),[t,o,a]),D=(0,l.useCallback)((function(e){e||(b(),k(!1))}),[b]),F=(0,l.useCallback)((function(e){if(c.current&&e.keyCode>48&&e.keyCode<58){var t=e.keyCode-48;i(c.current[t-1]),e.preventDefault(),e.stopPropagation()}}),[c,i]),K=(0,l.useCallback)((function(e){9===e.keyCode?f.current&&(C.current?.focus(),k(!0),e.preventDefault(),e.stopPropagation()):F(e)}),[F,f]),T=((0,l.useCallback)((function(){g(e)}),[e,g]),p!==e&&n?.length&&!r?"••••":n),B=null!=(m=c.current)?m:[],E=$(),M={value:T,ref:S,keyboardType:"ascii-capable",autoCapitalize:"none",autoCorrect:!1,spellCheck:!1,autoComplete:"off",size:P.md?"large":"medium",leftAddOnProps:{label:`${e+1}`,minWidth:"$10",justifyContent:"center"},error:r,onChangeText:_,onFocus:R,onBlur:A,returnKeyLabel:E.toUpperCase(),returnKeyType:E,autoFocus:0===e};return(0,y.jsx)(d.Popover,{title:"Select Word",placement:"bottom-start",usingSheet:!1,onOpenChange:D,open:!!f.current&&(p===e&&B.length>0),floatingPanelProps:{$md:{px:"$4",width:"100vw",outlineWidth:0,bg:"$transparent",borderWidth:0}},renderContent:(0,y.jsx)(d.Stack,{$md:{bg:"$bg",borderRadius:"$3"},children:(0,y.jsx)(x,{onKeyDown:F,children:(0,y.jsx)(SuggestionList,{firstButtonRef:C,suggestions:B,onPressItem:i,isFocusable:O})})}),renderTrigger:(0,y.jsx)(d.Stack,{children:(0,y.jsx)(d.Input,PhaseInputArea_objectSpread(PhaseInputArea_objectSpread({},M),{},{onKeyPress:K,"data-1p-ignore":!0,testID:v}))})})}));function PhaseInputArea({onConfirm:e,FooterComponent:t,showPhraseLengthSelector:n=!0,showClearAllButton:r=!0,defaultPhrases:u=[]}){var[c,i]=(0,l.useState)(S[0].value),{serviceAccount:p,servicePassword:f}=b.A,g=(0,l.useMemo)((function(){var e={};return a()(0,Number(c))?.forEach((function(t,n){e[`phrase${n+1}`]=u[n]||""})),e}),[u,c]),h=(0,d.useForm)({defaultValues:g}),v=(0,l.useCallback)((0,s.A)((function*(){var t=Object.values(h.getValues()).join(" "),n=yield f.encodeSensitiveText({text:t});yield p.validateMnemonic(n),e(n)})),[h,e,p,f]),{suggestions:j,updateInputValue:m,onInputFocus:x,onInputBlur:P,onInputChange:I,suggestionsRef:C,openStatusRef:O,selectInputIndex:k,closePopover:$,focusNextInput:R,onPasteMnemonic:A,isShowErrors:_}=useSuggestion(h,Number(c)),D=(0,l.useCallback)((function(e){e===Number(c)-1?v():R()}),[R,v,c]);(0,d.useKeyboardEvent)({keyboardWillHide:$});var F=(0,l.useCallback)((function(e){return e===Number(c)-1||o()(Object.values(h.getValues())).length===Number(c)?"done":"next"}),[h,c]),K=(0,l.useCallback)((function(){Object.entries(g).forEach((function([e,t]){h.setValue(e,t)}))}),[g,h]),T=(0,l.useCallback)((function(e){i(e),K()}),[K]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(d.Page.Body,{children:[n||r?(0,y.jsxs)(d.XStack,{px:"$5",pb:"$2",pt:"$2",justifyContent:"space-between",children:[n?(0,y.jsx)(d.Select,{title:"Select a length",placement:"bottom-start",items:S,value:c,onChange:T,renderTrigger:function({value:e}){return(0,y.jsxs)(d.Button,{iconAfter:"ChevronDownSmallOutline",size:"small",variant:"tertiary",testID:"phrase-length",children:[e," words"]})}}):null,r?(0,y.jsx)(d.Button,{icon:"BroomOutline",size:"small",variant:"tertiary",onPress:K,testID:"clear-all",children:"Clear"}):null]}):null,(0,y.jsx)(d.SecureView,{children:(0,y.jsx)(d.Form,{form:h,children:(0,y.jsx)(d.XStack,{px:"$4",flexWrap:"wrap",children:Array.from({length:Number(c)}).map((function(e,t){return(0,y.jsx)(d.Stack,{$md:{flexBasis:"50%"},flexBasis:"33.33%",p:"$1",children:(0,y.jsx)(d.Form.Field,{name:`phrase${t+1}`,children:(0,y.jsx)(w,{index:t,isShowError:_[t],onInputBlur:P,onInputChange:I,onInputFocus:x,onPasteMnemonic:A,suggestionsRef:C,updateInputValue:m,openStatusRef:O,selectInputIndex:k,closePopover:$,onReturnKeyPressed:D,getReturnKeyLabel:F,testID:`phrase-input-index${t}`})})},t)}))})})}),(0,y.jsxs)(d.HeightTransition,{children:[null,null]}),t]}),(0,y.jsx)(PageFooter,{suggestions:j,updateInputValue:m,onConfirm:v})]})}},952954:(e,t,n)=>{"use strict";n.d(t,{U:()=>Tutorials,y:()=>c});var r=n(324586),o=n(839850),s=n(490343),u=n(831085),a=["list"];function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tutorials(e){var{list:t}=e,n=(0,o.A)(e,a);return(0,u.jsx)(s.Stack,_objectSpread(_objectSpread({mt:"$10"},n),{},{children:t.map((function({title:e,description:t,iconName:n},r){return(0,u.jsxs)(s.XStack,_objectSpread(_objectSpread({},0!==r&&{mt:"$5"}),{},{children:[n?(0,u.jsx)(s.Stack,{px:"$0.5",mr:"$4",children:(0,u.jsx)(s.Icon,{name:n,flexShrink:0,color:"$iconSubdued",size:"$5"})}):null,(0,u.jsxs)(s.Stack,{flex:1,children:[(0,u.jsx)(s.SizableText,{size:"$bodyMd",children:e}),(0,u.jsx)(s.SizableText,{size:"$bodyMd",mt:"$1",color:"$textSubdued",children:t})]})]}),e)}))}))}var c=[{title:"What is a recovery phrase?",description:"A series of 12, 18, or 24 words to restore your wallet."},{title:"Is it safe to enter it into OneKey?",description:"Yes, it's stored locally and never shared without consent."},{title:"Why can't I type full words?",description:"To prevent keylogger attacks. Use suggested words for security."},{title:"Why can't I paste directly?",description:"To reduce risk of asset loss, avoid pasting sensitive information."}]},88539:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ImportRecoveryPhrase:()=>ImportRecoveryPhrase,default:()=>l});var r=n(514041),o=n(490343),s=n(498356),u=n(730223),a=n(632617),c=n(952954),i=n(831085);function ImportRecoveryPhrase(){var e=(0,s.A)(),t=(0,r.useCallback)((function(t){e.push(u.xl.FinalizeWalletSetup,{mnemonic:t})}),[e]),n=(0,r.useMemo)((function(){return(0,i.jsx)(a.b,{defaultPhrases:[],onConfirm:t,FooterComponent:(0,i.jsx)(c.U,{px:"$5",list:c.y})})}),[t]);return(0,i.jsxs)(o.Page,{scrollEnabled:!0,children:[(0,i.jsx)(o.Page.Header,{title:"Import Recovery Phrase"}),n]})}const l=ImportRecoveryPhrase},259668:(e,t,n)=>{var r=n(284354),o=n(63151);e.exports=function arrayShuffle(e){return o(r(e))}},796902:e=>{var t=Math.ceil,n=Math.max;e.exports=function baseRange(e,r,o,s){for(var u=-1,a=n(t((r-e)/(o||1)),0),c=Array(a);a--;)c[s?a:++u]=e,e+=o;return c}},927154:(e,t,n)=>{var r=n(63151),o=n(39817);e.exports=function baseShuffle(e){return r(o(e))}},803905:(e,t,n)=>{var r=n(965111);e.exports=function baseValues(e,t){return r(t,(function(t){return e[t]}))}},840165:(e,t,n)=>{var r=n(796902),o=n(674535),s=n(743301);e.exports=function createRange(e){return function(t,n,u){return u&&"number"!=typeof u&&o(t,n,u)&&(n=u=void 0),t=s(t),void 0===n?(n=t,t=0):n=s(n),u=void 0===u?t<n?1:-1:s(u),r(t,n,u,e)}}},63151:(e,t,n)=>{var r=n(306484);e.exports=function shuffleSelf(e,t){var n=-1,o=e.length,s=o-1;for(t=void 0===t?o:t;++n<t;){var u=r(n,s),a=e[u];e[u]=e[n],e[n]=a}return e.length=t,e}},516238:e=>{e.exports=function compact(e){for(var t=-1,n=null==e?0:e.length,r=0,o=[];++t<n;){var s=e[t];s&&(o[r++]=s)}return o}},573758:(e,t,n)=>{var r=n(840165)();e.exports=r},630938:(e,t,n)=>{var r=n(259668),o=n(927154),s=n(153142);e.exports=function shuffle(e){return(s(e)?r:o)(e)}},39817:(e,t,n)=>{var r=n(803905),o=n(781211);e.exports=function values(e){return null==e?[]:r(e,o(e))}}}]);