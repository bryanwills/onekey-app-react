"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[18649],{536612:(e,t,n)=>{n.d(t,{S:()=>useAppUpdateInfo,x:()=>useAppChangeLog});var a=n(324586),r=n(514041),s=n(734809),o=n(713132),i=n(639451),c=n(730223),l=n(310955),u=n(498356),p=n(911998);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var useAppChangeLog=function(e){var t=(0,p.yk)((function(){return e?l.A.serviceAppUpdate.fetchChangeLog():Promise.resolve(null)}),[e]);return(0,r.useMemo)((function(){return t.result}),[t.result])},useAppUpdateInfo=function(e=!1){var[t]=(0,s.useAppUpdatePersistAtom)(),n=(0,u.A)(),a=(0,r.useCallback)((function(){setTimeout((function(){(e?n.pushFullModal:n.pushModal)(c.ry.AppUpdateModal,{screen:c.mk.WhatsNew})}))}),[e,n.pushFullModal,n.pushModal]),p=(0,r.useCallback)((function(e=!1,a){(e?n.pushFullModal:n.pushModal)(c.ry.AppUpdateModal,{screen:c.mk.UpdatePreview,params:_objectSpread({latestVersion:t.latestVersion,isForceUpdate:t.isForceUpdate,autoClose:e},a)})}),[t.isForceUpdate,t.latestVersion,n.pushFullModal,n.pushModal]);(0,r.useEffect)((function(){(0,o.fK)(t)&&a(),t.status===o.ue.downloading&&(0,i.Xo)(t).then((function(){l.A.serviceAppUpdate.readyToInstall()})).catch((function(e){l.A.serviceAppUpdate.notifyFailed(e)})),l.A.serviceAppUpdate.fetchAppUpdateInfo().then((function(e){e?.isForceUpdate&&(0,o._q)(e.latestVersion,e.status)&&p(!0,e)}))}),[]);var d=(0,r.useCallback)((function(){switch(t.status){case o.ue.notify:case o.ue.downloading:p(e);break;case o.ue.ready:(0,i.Ed)(t).catch((function(e){return l.A.serviceAppUpdate.notifyFailed(e)}));break;case o.ue.failed:l.A.serviceAppUpdate.startDownloading(),(0,i.Xo)(t).then((function(){l.A.serviceAppUpdate.readyToInstall()})).catch((function(e){l.A.serviceAppUpdate.notifyFailed(e)}))}}),[t,e,p]);return(0,r.useMemo)((function(){return{isNeedUpdate:(0,o._q)(t.latestVersion,t.status),data:t,onUpdateAction:d,toUpdatePreviewPage:p,onViewReleaseInfo:a}}),[t,d,a,p])}},331250:(e,t,n)=>{n.d(t,{l:()=>ViewUpdateHistory});var a=n(514041),r=n(490343),s=n(117746),o=n(831085);function ViewUpdateHistory(){var e=(0,a.useCallback)((function(){(0,s.Dr)("https://github.com/OneKeyHQ/app-monorepo/releases")}),[]);return(0,o.jsx)(r.XStack,{children:(0,o.jsx)(r.Button,{mt:"$5",iconAfter:"ArrowTopRightOutline",onPress:e,size:"small",children:"Update History"})})}},418649:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var a=n(490343),r=n(663522),s=n(536612),o=n(331250),i=n(831085);const c=function WhatsNew(){var{version:e=""}=r.Ay,{gtMd:t}=(0,a.useMedia)(),n=(0,s.x)(e);return(0,i.jsxs)(a.Page,{children:[(0,i.jsx)(a.Page.Header,{title:"What's New"}),(0,i.jsxs)(a.Page.Body,{m:"$5",children:[(0,i.jsx)(a.YStack,{space:"$3",children:t?(0,i.jsx)(a.Heading,{size:"$heading2xl",children:`Whatâ€™s New in OneKey ${e} ðŸ‘‹ðŸ»`}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.Heading,{size:"$heading2xl",children:"Whatâ€™s New"}),(0,i.jsx)(a.Heading,{size:"$heading2xl",children:`in OneKey ${e} ðŸ‘‹ðŸ»`})]})}),n?(0,i.jsxs)(a.ScrollView,{mt:"$7",contentInsetAdjustmentBehavior:"automatic",contentContainerStyle:{pb:"$5"},children:[(0,i.jsx)(a.Markdown,{children:n}),(0,i.jsx)(o.l,{})]}):null]}),(0,i.jsx)(a.Page.Footer,{onCancelText:"I Got It",onCancel:function(e){e()}})]})}},639451:(e,t,n)=>{n.d(t,{Ed:()=>i,Xo:()=>o,xf:()=>useDownloadProgress});var a,r,s=n(586330),o=(a=(0,s.A)((function*(){})),function downloadPackage(){return a.apply(this,arguments)}),i=(r=(0,s.A)((function*(){})),function installPackage(){return r.apply(this,arguments)}),useDownloadProgress=function(){return 0}}}]);