"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[82411],{326745:(e,t,n)=>{n.d(t,{u:()=>useAppRoute});var o=n(728234);function useAppRoute(){return(0,o.lq)()}},188392:(e,t,n)=>{n.d(t,{d:()=>LidoWithdraw});var o=n(586330),i=n(514041),r=n(241440),a=n(490343),c=n(88803),s=n(791088),u=n(391944),l=n(734809),d=n(827843),p=n(831085),LidoWithdraw=function({balance:e,price:t,tokenImageUri:n,tokenSymbol:m,receivingTokenSymbol:f,minAmount:b="0",rate:k="1",onConfirm:y}){var[g,h]=(0,i.useState)(!1),[S,x]=(0,i.useState)(""),[{currencyInfo:{symbol:I}}]=(0,l.useSettingsPersistAtom)(),v=(0,i.useCallback)((0,o.A)((function*(){try{h(!0),yield y?.(S)}finally{h(!1)}})),[S,y]),j=(0,i.useCallback)((function(e){new r.A(e).isNaN()?""===e&&x(""):x(e)}),[]),w=(0,i.useMemo)((function(){var e=new r.A(S);if(!e.isNaN())return e.multipliedBy(t).toFixed()}),[S,t]),A=(0,i.useMemo)((function(){return new r.A(S).gt(e)}),[S,e]),P=(0,i.useMemo)((function(){var e=new r.A(b),t=new r.A(S);return!(!e.isGreaterThan(0)||!t.isGreaterThan(0))&&t.isLessThan(e)}),[b,S]),T=(0,i.useCallback)((function(){j(e)}),[j,e]),O=(0,i.useMemo)((function(){return(0,r.A)(S).isNaN()||A||P}),[S,A,P]),C=(0,i.useMemo)((function(){var e=(0,r.A)(S);if(e.isNaN())return null;var n=e.dividedBy(k).toFixed(),o=e.multipliedBy(t).dividedBy(k).toFixed();return(0,p.jsx)(a.XStack,{space:"$1",children:(0,p.jsxs)(a.SizableText,{children:[(0,p.jsx)(a.NumberSizeableText,{formatter:"balance",formatterOptions:{tokenSymbol:f},children:n}),"(",(0,p.jsx)(a.NumberSizeableText,{formatter:"value",formatterOptions:{currency:I},children:o}),")"]})})}),[S,t,I,f,k]);return(0,p.jsxs)(a.Page,{children:[(0,p.jsx)(a.Page.Header,{title:"Redeem"}),(0,p.jsx)(a.Page.Body,{children:(0,p.jsxs)(a.YStack,{children:[(0,p.jsxs)(a.Stack,{mx:"$2",px:"$3",space:"$5",children:[(0,p.jsx)(c.J,{hasError:A||P,value:S,onChange:j,tokenSelectorTriggerProps:{selectedTokenImageUri:n,selectedTokenSymbol:m},inputProps:{placeholder:"0"},balanceProps:{value:e,onPress:T},valueProps:{value:w,currency:w?I:void 0},enableMaxAmount:!0}),(0,p.jsxs)(a.YStack,{space:"$1",children:[P?(0,p.jsx)(a.Alert,{icon:"InfoCircleOutline",type:"critical",title:`The minimum amount for this staking is ${b} ${m}.`}):null,A?(0,p.jsx)(a.Alert,{icon:"InfoCircleOutline",type:"critical",title:"Insufficient balance."}):null]})]}),(0,p.jsxs)(a.YStack,{children:[C?(0,p.jsx)(s.c,{title:"Receive",titleProps:{color:"$textSubdued"},children:C}):null,S?(0,p.jsx)(s.c,{title:"Pay with",titleProps:{color:"$textSubdued"},children:(0,p.jsx)(a.SizableText,{children:(0,p.jsx)(a.NumberSizeableText,{formatter:"balance",formatterOptions:{tokenSymbol:m},children:S})})}):null,(0,p.jsx)(s.c,{title:"Protocol",titleProps:{color:"$textSubdued"},children:(0,p.jsxs)(a.XStack,{space:"$2",alignItems:"center",children:[(0,p.jsx)(u.o,{size:"sm",tokenImageUri:d.a3}),(0,p.jsx)(a.SizableText,{size:"$bodyMdMedium",children:"Lido"})]})}),(0,p.jsx)(s.c,{title:"Stake Release Period",titleProps:{color:"$textSubdued"},children:(0,p.jsx)(s.c.Text,{primary:"< 4 Days"})})]})]})}),(0,p.jsx)(a.Page.Footer,{onConfirmText:"Redeem",confirmButtonProps:{onPress:v,loading:g,disabled:O}})]})}},440905:(e,t,n)=>{n.d(t,{IM:()=>useLidoClaim,Ow:()=>useLidoWithdraw,cx:()=>useLidoStake});var o=n(324586),i=n(586330),r=n(514041),a=n(310955),c=n(927799),s=n(161024);function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){(0,o.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function useLidoStake({networkId:e,accountId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:t,networkId:e});return(0,r.useCallback)((n=(0,i.A)((function*({amount:n,stakingInfo:i,onSuccess:r,onFail:c}){var s=yield a.A.serviceAccount.getAccount({accountId:t,networkId:e}),u=yield a.A.serviceStaking.buildLidoEthStakingTransaction({amount:n,networkId:e});yield o({encodedTx:_objectSpread(_objectSpread({},u),{},{from:s.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[o,t,e])}function useLidoWithdraw({networkId:e,accountId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:t,networkId:e});return(0,r.useCallback)((n=(0,i.A)((function*({amount:n,stakingInfo:i,onSuccess:r,onFail:c}){var u=yield a.A.serviceAccount.getAccount({accountId:t,networkId:e}),{message:l,deadline:d}=yield a.A.serviceStaking.buildLidoEthPermitMessage({accountId:t,networkId:e,amount:n}),p=yield a.A.serviceDApp.openSignMessageModal({accountId:t,networkId:e,request:{origin:"https://www.onekey.so",scope:"ethereum"},unsignedMessage:{type:s.$.TYPED_DATA_V4,message:l}}),m=yield a.A.serviceStaking.buildLidoEthWithdrawalTransaction({amount:n,signature:p,networkId:e,accountId:t,deadline:d});yield o({encodedTx:_objectSpread(_objectSpread({},m),{},{from:u.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[t,e,o])}function useLidoClaim({networkId:e,accountId:t}){var n,{navigationToSendConfirm:o}=(0,c.E)({accountId:t,networkId:e});return(0,r.useCallback)((n=(0,i.A)((function*({requestIds:n,stakingInfo:i,onSuccess:r,onFail:c}){var s=yield a.A.serviceAccount.getAccount({accountId:t,networkId:e}),u=yield a.A.serviceStaking.buildLidoEthClaimTransaction({requestIds:n,networkId:e});yield o({encodedTx:_objectSpread(_objectSpread({},u),{},{from:s.address}),stakingInfo:i,onSuccess:r,onFail:c})})),function(e){return n.apply(this,arguments)}),[o,t,e])}},382411:(e,t,n)=>{n.r(t),n.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var o=n(586330),i=n(514041),r=n(241440),a=n(498356),c=n(326745),s=n(188392),u=n(440905),l=n(831085);const __WEBPACK_DEFAULT_EXPORT__=function(){var e,t=(0,c.u)(),{accountId:n,networkId:d,balance:p,token:m,price:f,receivingToken:b}=t.params,k=(0,a.A)(),y=(0,u.Ow)({accountId:n,networkId:d}),g=(0,i.useCallback)((e=(0,o.A)((function*(e){var t=(0,r.A)(e).shiftedBy(m.decimals).toFixed();yield y({amount:t,stakingInfo:{protocol:"lido",send:{token:m,amount:e},tags:["lido-eth"]},onSuccess:function(){return k.pop()}})})),function(t){return e.apply(this,arguments)}),[y,m,k]);return(0,l.jsx)(s.d,{receivingTokenSymbol:b.symbol,price:f,balance:p,minAmount:(0,r.A)(100).shiftedBy(-m.decimals).toFixed(),tokenSymbol:m.symbol,tokenImageUri:m.logoURI,onConfirm:g})}},827843:(e,t,n)=>{n.d(t,{$e:()=>a,Cp:()=>i,LN:()=>r,a3:()=>o});var o="https://uni.onekey-asset.com/static/logo/Lido.png",i="https://uni.onekey-asset.com/static/chain/eth.png",r="https://uni.onekey-asset.com/static/chain/polygon.png",a="https://lido.fi/"}}]);