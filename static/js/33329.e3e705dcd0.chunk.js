(self.webpackChunkweb=self.webpackChunkweb||[]).push([[33329],{940916:(e,r,t)=>{"use strict";t.d(r,{G:()=>g});var n=t(482451),i=t.n(n),s=t(324586),o=t(586330),a=t(230414),u=t(507140),c=t(606777),d=t(554902),p=t(180556),f=t(929296),l=t(195309),h=t(972715),y=t(901048).Buffer;function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,h.A)(e);if(r){var i=(0,h.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,l.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var v=function(e){(0,f.A)(ChainSigner,e);var r=_createSuper(ChainSigner);function ChainSigner(e,t,n){var i,s=(0,d.N)(n,{key:e,chainCode:y.alloc(32)},t).key.toString("hex");return(i=r.call(this,s,n)).encryptedPrivateKey=e,i.password=t,i.curve=n,i}var t,n=ChainSigner.prototype;return n.getPrvkey=function getPrvkey(){return Promise.resolve((0,d.Yc)(this.password,this.encryptedPrivateKey))},n.getPrvkeyHex=(t=(0,o.A)((function*(){return c.A.bytesToHex(yield this.getPrvkey())})),function getPrvkeyHex(){return t.apply(this,arguments)}),n.sign=function sign(e){var r=(0,d._S)(this.curve,this.encryptedPrivateKey,e,this.password);return"secp256k1"===this.curve?Promise.resolve([r.slice(0,-1),r[r.length-1]]):Promise.resolve([r,0])},(0,a.A)(ChainSigner)}(function(){function Verifier(e,r){this.curve=r,this.compressedPublicKey=y.from(e,"hex"),this.uncompressedPublicKey=(0,d.sA)(r,this.compressedPublicKey)}var e,r=Verifier.prototype;return r.getPubkey=function getPubkey(e){return Promise.resolve(e?this.compressedPublicKey:this.uncompressedPublicKey)},r.getPubkeyHex=(e=(0,o.A)((function*(e){return c.A.bytesToHex(yield this.getPubkey(e))})),function getPubkeyHex(r){return e.apply(this,arguments)}),r.verify=function verify(){return Promise.resolve(y.from([]))},r.verifySignature=function verifySignature({publicKey:e,digest:r,signature:t}){var n=c.A.toBuffer(e),i=c.A.toBuffer(r),s=c.A.toBuffer(t),{curve:o}=this,a=(0,d.MX)(o,n,i,s);return Promise.resolve(a)},(0,a.A)(Verifier)}());function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,s.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var g=function(){function CoreChainApiBase(){}var e,r,t,n,s,f=CoreChainApiBase.prototype;return f.baseGetCurve=function baseGetCurve(e){switch(e){case"ed25519":return d.ev;case"secp256k1":return d.bI;case"nistp256":return d.OX;default:throw new u.He("Unsupported curve")}},f.baseCreateSigner=(e=(0,o.A)((function*({curve:e,privateKey:r,password:t}){if(void 0===t)throw new u.He("Software signing requires a password.");var n=c.A.toBuffer(r);return Promise.resolve(new v(n,t,e))})),function baseCreateSigner(r){return e.apply(this,arguments)}),f.baseGetSingleSigner=(r=(0,o.A)((function*({payload:e,curve:r}){var t=yield this.getPrivateKeys(e),n=e.account.path,i=t[n],s=e.account.relPaths?.[0];if(!i&&s&&(i=t[[n,s].join("/")]),!i)throw new Error(`No private key found: ${n}`);return this.baseCreateSigner({curve:r,privateKey:i,password:e.password})})),function baseGetSingleSigner(e){return r.apply(this,arguments)}),f.baseGetPrivateKeys=(t=(0,o.A)((function*({payload:e,curve:r}){var{credentials:t,account:n,password:i}=e,s={};if(t.hd&&t.imported)throw new u.He("getPrivateKeys ERROR: hd and imported credentials can NOT both set.");if(t.hd){var{relPaths:o}=n;s=yield this.baseGetPrivateKeysHd({curve:r,account:n,hdCredential:t.hd,password:i,relPaths:o})}if(t.imported){var{privateKey:a}=(0,d.VV)({password:i,credential:t.imported}),p=c.A.bytesToHex((0,d.w)(i,a));s[n.path]=p,s[""]=p}if(!Object.keys(s).length)throw new Error("No private keys found");return s})),function baseGetPrivateKeys(e){return t.apply(this,arguments)}),f.baseGetPrivateKeysHd=(n=(0,o.A)((function*({curve:e,password:r,account:t,relPaths:n,hdCredential:i}){var{path:s}=t,o=s.split("/"),a=n||[o.pop()],p=o.join("/");if(0===a.length)throw new u.He("getPrivateKeysHd ERROR: relPaths is empty.");return(0,d.Wu)(e,i,r,p,a).reduce((function(e,r){return _objectSpread(_objectSpread({},e),{},{[r.path]:c.A.bytesToHex(r.extendedKey.key)})}),{})})),function baseGetPrivateKeysHd(e){return n.apply(this,arguments)}),f.baseGetAddressesFromHd=(s=(0,o.A)((function*(e,r){var t=this,{curve:n,generateFrom:s}=r,{template:a,hdCredential:f,password:l,indexes:h}=e,{pathPrefix:y,pathSuffix:v}=(0,p.Ah)(a),g=h.map((function(e){return v.replace("{index}",e.toString())})),w="privateKey"===s,b=[],A=[];w?A=(0,d.Wu)(n,f,l,y,g):b=(0,d.W6)(n,f,l,y,g);var P=w?A:b;if(P.length!==h.length)throw new u.He("Unable to get publick key.");var m,k=yield Promise.all(P.map((m=(0,o.A)((function*(r){var n,s,{path:o,extendedKey:{key:a}}=r;if(w){var u=c.A.bytesToHex((0,d.Yc)(l,a));s=yield t.getAddressFromPrivate({networkInfo:e.networkInfo,privateKeyRaw:u,privateKeyInfo:r})}else n=a.toString("hex"),s=yield t.getAddressFromPublic({networkInfo:e.networkInfo,publicKey:n,publicKeyInfo:r});return i()({publicKey:n,path:o},s)})),function(e){return m.apply(this,arguments)})));return{addresses:k}})),function baseGetAddressesFromHd(e,r){return s.apply(this,arguments)}),(0,a.A)(CoreChainApiBase)}()},476144:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});var n=t(230414),i=t(929296),s=t(195309),o=t(972715);function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,o.A)(e);if(r){var i=(0,o.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,s.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var a=function(e){(0,i.A)(CoreChainImported,e);var r=_createSuper(CoreChainImported);function CoreChainImported(){return r.apply(this,arguments)}return(0,n.A)(CoreChainImported)}(t(603973).A)},603973:(e,r,t)=>{"use strict";t.d(r,{A:()=>j});var n,i=t(586330),s=t(230414),o=t(929296),a=t(195309),u=t(972715),c=t(717288),d=t(236989),p=t.n(d),f=t(56075),l=t.n(f),h=t(928557),y=t(825145),v=t(606777),g=t(940916),w=t(554902),b=t(824116),A=t(529848),P=t.n(A),m=t(507140),k=t(404727),C=t(901048).Buffer,S=(n=(0,i.A)((function*({curve:e,indexes:r,hdCredential:t,password:n,isTestnet:s}){var o=`m/84'/${s?h.gU:h.sR}'`,a=r.map((function(e){return`${e.toString()}'`})),u=(0,w.W6)(e,t,n,o,a);if(u.length!==r.length)throw new m.He("Unable to get publick key.");var c,d=s?h.Jj:h.PA,p=(0,b.getBtcForkNetwork)(d),{public:f}=(p.segwitVersionBytes||{})[k.EAddressEncodings.P2WPKH]||p.bip32,l=[C.from(f.toString(16).padStart(8,"0"),"hex"),C.from([3])],y=yield Promise.all(u.map((c=(0,i.A)((function*(t,n){var{path:i,parentFingerPrint:s,extendedKey:o}=t,a=P().encode(C.concat([...l,s,C.from((r[n]+2**31).toString(16).padStart(8,"0"),"hex"),o.chainCode,o.key])),u="0/0",c=[u],{addresses:d}=yield(0,b.getAddressFromXpub)({curve:e,network:p,xpub:a,relativePaths:c,addressEncoding:k.EAddressEncodings.P2WPKH,encodeAddress:function(e){return e}}),{[u]:f}=d;return{accountIndex:r[n],address:f,publicKey:a,path:i,relPath:u}})),function(e,r){return c.apply(this,arguments)})));return y})),function generateNativeSegwitAccounts(e){return n.apply(this,arguments)}),K=t(97713),x=t(552001),H=t(901048).Buffer;var B=t(913360),I=t.n(B),T=t(901048).Buffer,R=new(I().ec)("secp256k1");const O=function(){function HashKeySigner(e){if(this.keyHex=e,!e)throw new Error("Invalid key");this.sk=R.keyFromPrivate(T.from(e,"hex"))}var e=HashKeySigner.prototype;return e.sign=function sign(e){if(!e)throw new Error("Invalid message");return this.sk.sign(e,{canonical:!0})},e.verify=function verify(e,r){try{return this.sk.verify(e,r)}catch(e){return console.error(e),!1}},(0,s.A)(HashKeySigner,[{key:"pk",get:function(){return this.sk.getPublic()}},{key:"pkHex",get:function(){return this.pk.encodeCompressed("hex")}}]),HashKeySigner}();var E=t(901048).Buffer;function _createSuper(e){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var t,n=(0,u.A)(e);if(r){var i=(0,u.A)(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return(0,a.A)(this,t)}}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}var _="secp256k1",j=function(e){(0,o.A)(CoreChainSoftware,e);var r=_createSuper(CoreChainSoftware);function CoreChainSoftware(){return r.apply(this,arguments)}var t,n,a,u,d,f,g,A,P,m,k=CoreChainSoftware.prototype;return k.getPrivateKeys=(t=(0,i.A)((function*(e){return this.baseGetPrivateKeys({payload:e,curve:_})})),function getPrivateKeys(e){return t.apply(this,arguments)}),k.signTransaction=(n=(0,i.A)((function*(e){var{unsignedTx:r}=e,t=yield this.baseGetSingleSigner({payload:e,curve:_}),n=(r.encodedTx,v.A.toBuffer("")),[i]=yield t.sign(n);return{encodedTx:r.encodedTx,txid:"",rawTx:""}})),function signTransaction(e){return n.apply(this,arguments)}),k.signMessage=(a=(0,i.A)((function*(e){e.unsignedMsg;var r=yield this.baseGetSingleSigner({payload:e,curve:_}),t=v.A.toBuffer(""),[n]=yield r.sign(t);return""})),function signMessage(e){return a.apply(this,arguments)}),k.getAddressFromPrivate=(u=(0,i.A)((function*(e){var{privateKeyRaw:r}=e,t=v.A.toBuffer(r),n=this.baseGetCurve(_).publicFromPrivate(t);return this.getAddressFromPublic({publicKey:v.A.bytesToHex(n),networkInfo:e.networkInfo})})),function getAddressFromPrivate(e){return u.apply(this,arguments)}),k.getAddressFromPublic=(d=(0,i.A)((function*(e){var{publicKey:r}=e;return Promise.resolve({address:"",publicKey:r})})),function getAddressFromPublic(e){return d.apply(this,arguments)}),k.getAddressFromXpub=(f=(0,i.A)((function*({network:e,xpub:r,relativePaths:t,addressEncoding:n}){var{addresses:i}=yield(0,b.getAddressFromXpub)({curve:_,network:e,xpub:r,relativePaths:t,addressEncoding:n,encodeAddress:function(e){return e}});return i})),function getAddressFromXpub(e){return f.apply(this,arguments)}),k.buildSignerLightning=(g=(0,i.A)((function*({password:e,hdCredential:r,address:t,path:n,isTestnet:i}){var s=i?{networkChainCode:h.Jj,networkImpl:h.Jj,networkId:"tbtc--0",chainId:""}:{networkChainCode:h.PA,networkImpl:h.PA,networkId:"btc--0",chainId:""},o=`${n}/0/0`,a=yield this.getPrivateKeys({networkInfo:s,password:e,account:{address:t,path:o},credentials:{hd:r}});if(!a[o])throw new Error("No private key found.");return yield this.baseCreateSigner({curve:_,password:e,privateKey:a[o]})})),function buildSignerLightning(e){return g.apply(this,arguments)}),k.getAddressesFromHd=(A=(0,i.A)((function*(e){var{hdCredential:r,password:t,indexes:n,networkInfo:{networkChainCode:i}}=e,s=i===h.gM;return{addresses:yield S({curve:_,indexes:n,hdCredential:r,password:t,isTestnet:s})}})),function getAddressesFromHd(e){return A.apply(this,arguments)}),k.signApiMessage=(P=(0,i.A)((function*({msgPayload:e,password:r,hdCredential:t,address:n,path:i,isTestnet:s}){var o=yield this.buildSignerLightning({password:r,hdCredential:t,address:n,path:i,isTestnet:s}),a=s?h.Jj:h.PA,u=(0,b.getBtcForkNetwork)(a),c=yield o.getPrvkey(),d=(0,b.getBitcoinECPair)().fromPrivateKey(c,{network:u});return p().sign(l()(e),(0,y.wT)(d.privateKey),d.compressed,{segwitType:"p2wpkh"}).toString("hex")})),function signApiMessage(e){return P.apply(this,arguments)}),k.lnurlAuth=(m=(0,i.A)((function*(e){var{password:r,credentials:t,lnurlDetail:n}=e,i=(0,w.s8)((0,y.wT)(t.hd),r),s=(0,b.getBitcoinBip32)().fromSeed((0,c.mnemonicToSeedSync)(i)),o=s.derivePath("m/138'/0").privateKey;if(!o)throw new Error("lnurl-auth: invalid hashing key");var a=new URL(n.url),u=function getPathSuffix(e,r){for(var t=v.A.bytesToHex((0,K.w)(x.s,H.from(e,"utf-8"),H.from(r,"hex"))),n=H.from(t,"hex"),i=[],s=0;s<4;s+=1)i.push(n.readUInt32BE(4*s));return i}(a.host,v.A.bytesToHex(o)),d=s.derivePath("m/138'");for(var p of u)d=d.derive(p);if(!d.privateKey)throw new Error("lnurl-auth: invalid linking private key");var f=v.A.bytesToHex(d.privateKey);if(!f)throw new Error("Invalid linkingKey");var l=new O(f),h=v.A.hexToBytes(n.k1),g=l.sign(h).toDER("hex"),A=a;return A.searchParams.set("sig",g),A.searchParams.set("key",l.pkHex),A.searchParams.set("t",Date.now().toString()),A.toString()})),function lnurlAuth(e){return m.apply(this,arguments)}),k.verifyMessage=function verifyMessage({message:e,address:r,signature:t}){var n=p().verify(e,r,E.from(t,"hex"));return Promise.resolve({isValid:n,message:e,address:r,signature:t})},(0,s.A)(CoreChainSoftware)}(g.G)},879314:()=>{}}]);